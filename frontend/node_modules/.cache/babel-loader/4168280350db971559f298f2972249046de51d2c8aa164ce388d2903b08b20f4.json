{"ast":null,"code":"import { m as mergeProps, g as guid, i as isArraysEqual, T as Theme, a as mapHash, B as BaseComponent, V as ViewContextType, C as ContentContainer, b as buildViewClassNames, c as greatestDurationDenominator, d as createDuration, e as BASE_OPTION_DEFAULTS, f as arrayToHash, h as filterHash, j as buildEventSourceRefiners, p as parseEventSource, k as formatWithOrdinals, u as unpromisify, l as buildRangeApiWithTimeZone, n as identity, r as requestJson, s as subtractDurations, o as intersectRanges, q as startOfDay, t as addDays, v as hashValuesToArray, w as buildEventApis, D as DelayedRunner, x as createFormatter, y as diffWholeDays, z as memoize, A as memoizeObjArg, E as isPropsEqual, F as Emitter, G as getInitialDate, H as rangeContainsMarker, I as createEmptyEventStore, J as reduceCurrentDate, K as reduceEventStore, L as rezoneEventStoreDates, M as mergeRawOptions, N as BASE_OPTION_REFINERS, O as CALENDAR_LISTENER_REFINERS, P as CALENDAR_OPTION_REFINERS, Q as COMPLEX_OPTION_COMPARATORS, R as VIEW_OPTION_REFINERS, S as DateEnv, U as DateProfileGenerator, W as createEventUi, X as parseBusinessHours, Y as setRef, Z as Interaction, _ as getElSeg, $ as elementClosest, a0 as EventImpl, a1 as listenBySelector, a2 as listenToHoverBySelector, a3 as PureComponent, a4 as buildViewContext, a5 as getUniqueDomId, a6 as parseInteractionSettings, a7 as interactionSettingsStore, a8 as getNow, a9 as CalendarImpl, aa as flushSync, ab as CalendarRoot, ac as RenderId, ad as ensureElHasStyles, ae as applyStyleProp, af as sliceEventStore } from './internal-common.js';\nexport { ag as JsonRequestError } from './internal-common.js';\nimport { createElement, createRef, Fragment, render } from 'preact';\nimport 'preact/compat';\nconst globalLocales = [];\nconst MINIMAL_RAW_EN_LOCALE = {\n  code: 'en',\n  week: {\n    dow: 0,\n    doy: 4 // 4 days need to be within the year to be considered the first week\n  },\n  direction: 'ltr',\n  buttonText: {\n    prev: 'prev',\n    next: 'next',\n    prevYear: 'prev year',\n    nextYear: 'next year',\n    year: 'year',\n    today: 'today',\n    month: 'month',\n    week: 'week',\n    day: 'day',\n    list: 'list'\n  },\n  weekText: 'W',\n  weekTextLong: 'Week',\n  closeHint: 'Close',\n  timeHint: 'Time',\n  eventHint: 'Event',\n  allDayText: 'all-day',\n  moreLinkText: 'more',\n  noEventsText: 'No events to display'\n};\nconst RAW_EN_LOCALE = Object.assign(Object.assign({}, MINIMAL_RAW_EN_LOCALE), {\n  // Includes things we don't want other locales to inherit,\n  // things that derive from other translatable strings.\n  buttonHints: {\n    prev: 'Previous $0',\n    next: 'Next $0',\n    today(buttonText, unit) {\n      return unit === 'day' ? 'Today' : \"This \".concat(buttonText);\n    }\n  },\n  viewHint: '$0 view',\n  navLinkHint: 'Go to $0',\n  moreLinkHint(eventCnt) {\n    return \"Show \".concat(eventCnt, \" more event\").concat(eventCnt === 1 ? '' : 's');\n  }\n});\nfunction organizeRawLocales(explicitRawLocales) {\n  let defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n  let allRawLocales = globalLocales.concat(explicitRawLocales);\n  let rawLocaleMap = {\n    en: RAW_EN_LOCALE\n  };\n  for (let rawLocale of allRawLocales) {\n    rawLocaleMap[rawLocale.code] = rawLocale;\n  }\n  return {\n    map: rawLocaleMap,\n    defaultCode\n  };\n}\nfunction buildLocale(inputSingular, available) {\n  if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n    return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n  }\n  return queryLocale(inputSingular, available);\n}\nfunction queryLocale(codeArg, available) {\n  let codes = [].concat(codeArg || []); // will convert to array\n  let raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n  return parseLocale(codeArg, codes, raw);\n}\nfunction queryRawLocale(codes, available) {\n  for (let i = 0; i < codes.length; i += 1) {\n    let parts = codes[i].toLocaleLowerCase().split('-');\n    for (let j = parts.length; j > 0; j -= 1) {\n      let simpleId = parts.slice(0, j).join('-');\n      if (available[simpleId]) {\n        return available[simpleId];\n      }\n    }\n  }\n  return null;\n}\nfunction parseLocale(codeArg, codes, raw) {\n  let merged = mergeProps([MINIMAL_RAW_EN_LOCALE, raw], ['buttonText']);\n  delete merged.code; // don't want this part of the options\n  let {\n    week\n  } = merged;\n  delete merged.week;\n  return {\n    codeArg,\n    codes,\n    week,\n    simpleNumberFormat: new Intl.NumberFormat(codeArg),\n    options: merged\n  };\n}\n\n// TODO: easier way to add new hooks? need to update a million things\nfunction createPlugin(input) {\n  return {\n    id: guid(),\n    name: input.name,\n    premiumReleaseDate: input.premiumReleaseDate ? new Date(input.premiumReleaseDate) : undefined,\n    deps: input.deps || [],\n    reducers: input.reducers || [],\n    isLoadingFuncs: input.isLoadingFuncs || [],\n    contextInit: [].concat(input.contextInit || []),\n    eventRefiners: input.eventRefiners || {},\n    eventDefMemberAdders: input.eventDefMemberAdders || [],\n    eventSourceRefiners: input.eventSourceRefiners || {},\n    isDraggableTransformers: input.isDraggableTransformers || [],\n    eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n    eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n    dateSelectionTransformers: input.dateSelectionTransformers || [],\n    datePointTransforms: input.datePointTransforms || [],\n    dateSpanTransforms: input.dateSpanTransforms || [],\n    views: input.views || {},\n    viewPropsTransformers: input.viewPropsTransformers || [],\n    isPropsValid: input.isPropsValid || null,\n    externalDefTransforms: input.externalDefTransforms || [],\n    viewContainerAppends: input.viewContainerAppends || [],\n    eventDropTransformers: input.eventDropTransformers || [],\n    componentInteractions: input.componentInteractions || [],\n    calendarInteractions: input.calendarInteractions || [],\n    themeClasses: input.themeClasses || {},\n    eventSourceDefs: input.eventSourceDefs || [],\n    cmdFormatter: input.cmdFormatter,\n    recurringTypes: input.recurringTypes || [],\n    namedTimeZonedImpl: input.namedTimeZonedImpl,\n    initialView: input.initialView || '',\n    elementDraggingImpl: input.elementDraggingImpl,\n    optionChangeHandlers: input.optionChangeHandlers || {},\n    scrollGridImpl: input.scrollGridImpl || null,\n    listenerRefiners: input.listenerRefiners || {},\n    optionRefiners: input.optionRefiners || {},\n    propSetHandlers: input.propSetHandlers || {}\n  };\n}\nfunction buildPluginHooks(pluginDefs, globalDefs) {\n  let currentPluginIds = {};\n  let hooks = {\n    premiumReleaseDate: undefined,\n    reducers: [],\n    isLoadingFuncs: [],\n    contextInit: [],\n    eventRefiners: {},\n    eventDefMemberAdders: [],\n    eventSourceRefiners: {},\n    isDraggableTransformers: [],\n    eventDragMutationMassagers: [],\n    eventDefMutationAppliers: [],\n    dateSelectionTransformers: [],\n    datePointTransforms: [],\n    dateSpanTransforms: [],\n    views: {},\n    viewPropsTransformers: [],\n    isPropsValid: null,\n    externalDefTransforms: [],\n    viewContainerAppends: [],\n    eventDropTransformers: [],\n    componentInteractions: [],\n    calendarInteractions: [],\n    themeClasses: {},\n    eventSourceDefs: [],\n    cmdFormatter: null,\n    recurringTypes: [],\n    namedTimeZonedImpl: null,\n    initialView: '',\n    elementDraggingImpl: null,\n    optionChangeHandlers: {},\n    scrollGridImpl: null,\n    listenerRefiners: {},\n    optionRefiners: {},\n    propSetHandlers: {}\n  };\n  function addDefs(defs) {\n    for (let def of defs) {\n      const pluginName = def.name;\n      const currentId = currentPluginIds[pluginName];\n      if (currentId === undefined) {\n        currentPluginIds[pluginName] = def.id;\n        addDefs(def.deps);\n        hooks = combineHooks(hooks, def);\n      } else if (currentId !== def.id) {\n        // different ID than the one already added\n        console.warn(\"Duplicate plugin '\".concat(pluginName, \"'\"));\n      }\n    }\n  }\n  if (pluginDefs) {\n    addDefs(pluginDefs);\n  }\n  addDefs(globalDefs);\n  return hooks;\n}\nfunction buildBuildPluginHooks() {\n  let currentOverrideDefs = [];\n  let currentGlobalDefs = [];\n  let currentHooks;\n  return (overrideDefs, globalDefs) => {\n    if (!currentHooks || !isArraysEqual(overrideDefs, currentOverrideDefs) || !isArraysEqual(globalDefs, currentGlobalDefs)) {\n      currentHooks = buildPluginHooks(overrideDefs, globalDefs);\n    }\n    currentOverrideDefs = overrideDefs;\n    currentGlobalDefs = globalDefs;\n    return currentHooks;\n  };\n}\nfunction combineHooks(hooks0, hooks1) {\n  return {\n    premiumReleaseDate: compareOptionalDates(hooks0.premiumReleaseDate, hooks1.premiumReleaseDate),\n    reducers: hooks0.reducers.concat(hooks1.reducers),\n    isLoadingFuncs: hooks0.isLoadingFuncs.concat(hooks1.isLoadingFuncs),\n    contextInit: hooks0.contextInit.concat(hooks1.contextInit),\n    eventRefiners: Object.assign(Object.assign({}, hooks0.eventRefiners), hooks1.eventRefiners),\n    eventDefMemberAdders: hooks0.eventDefMemberAdders.concat(hooks1.eventDefMemberAdders),\n    eventSourceRefiners: Object.assign(Object.assign({}, hooks0.eventSourceRefiners), hooks1.eventSourceRefiners),\n    isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n    eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n    eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n    dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n    datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n    dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n    views: Object.assign(Object.assign({}, hooks0.views), hooks1.views),\n    viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n    isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n    externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n    viewContainerAppends: hooks0.viewContainerAppends.concat(hooks1.viewContainerAppends),\n    eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n    calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n    componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n    themeClasses: Object.assign(Object.assign({}, hooks0.themeClasses), hooks1.themeClasses),\n    eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n    cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n    recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n    namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n    initialView: hooks0.initialView || hooks1.initialView,\n    elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n    optionChangeHandlers: Object.assign(Object.assign({}, hooks0.optionChangeHandlers), hooks1.optionChangeHandlers),\n    scrollGridImpl: hooks1.scrollGridImpl || hooks0.scrollGridImpl,\n    listenerRefiners: Object.assign(Object.assign({}, hooks0.listenerRefiners), hooks1.listenerRefiners),\n    optionRefiners: Object.assign(Object.assign({}, hooks0.optionRefiners), hooks1.optionRefiners),\n    propSetHandlers: Object.assign(Object.assign({}, hooks0.propSetHandlers), hooks1.propSetHandlers)\n  };\n}\nfunction compareOptionalDates(date0, date1) {\n  if (date0 === undefined) {\n    return date1;\n  }\n  if (date1 === undefined) {\n    return date0;\n  }\n  return new Date(Math.max(date0.valueOf(), date1.valueOf()));\n}\nclass StandardTheme extends Theme {}\nStandardTheme.prototype.classes = {\n  root: 'fc-theme-standard',\n  tableCellShaded: 'fc-cell-shaded',\n  buttonGroup: 'fc-button-group',\n  button: 'fc-button fc-button-primary',\n  buttonActive: 'fc-button-active'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n  close: 'fc-icon-x',\n  prev: 'fc-icon-chevron-left',\n  next: 'fc-icon-chevron-right',\n  prevYear: 'fc-icon-chevrons-left',\n  nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.rtlIconClasses = {\n  prev: 'fc-icon-chevron-right',\n  next: 'fc-icon-chevron-left',\n  prevYear: 'fc-icon-chevrons-right',\n  nextYear: 'fc-icon-chevrons-left'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons'; // TODO: make TS-friendly\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n  let hash = {};\n  let viewType;\n  for (viewType in defaultConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n  for (viewType in overrideConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n  return hash;\n}\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  if (hash[viewType]) {\n    return hash[viewType];\n  }\n  let viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  if (viewDef) {\n    hash[viewType] = viewDef;\n  }\n  return viewDef;\n}\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  let defaultConfig = defaultConfigs[viewType];\n  let overrideConfig = overrideConfigs[viewType];\n  let queryProp = name => defaultConfig && defaultConfig[name] !== null ? defaultConfig[name] : overrideConfig && overrideConfig[name] !== null ? overrideConfig[name] : null;\n  let theComponent = queryProp('component');\n  let superType = queryProp('superType');\n  let superDef = null;\n  if (superType) {\n    if (superType === viewType) {\n      throw new Error('Can\\'t have a custom view type that references itself');\n    }\n    superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n  }\n  if (!theComponent && superDef) {\n    theComponent = superDef.component;\n  }\n  if (!theComponent) {\n    return null; // don't throw a warning, might be settings for a single-unit view\n  }\n  return {\n    type: viewType,\n    component: theComponent,\n    defaults: Object.assign(Object.assign({}, superDef ? superDef.defaults : {}), defaultConfig ? defaultConfig.rawOptions : {}),\n    overrides: Object.assign(Object.assign({}, superDef ? superDef.overrides : {}), overrideConfig ? overrideConfig.rawOptions : {})\n  };\n}\nfunction parseViewConfigs(inputs) {\n  return mapHash(inputs, parseViewConfig);\n}\nfunction parseViewConfig(input) {\n  let rawOptions = typeof input === 'function' ? {\n    component: input\n  } : input;\n  let {\n    component\n  } = rawOptions;\n  if (rawOptions.content) {\n    // TODO: remove content/classNames/didMount/etc from options?\n    component = createViewHookComponent(rawOptions);\n  } else if (component && !(component.prototype instanceof BaseComponent)) {\n    // WHY?: people were using `component` property for `content`\n    // TODO: converge on one setting name\n    component = createViewHookComponent(Object.assign(Object.assign({}, rawOptions), {\n      content: component\n    }));\n  }\n  return {\n    superType: rawOptions.type,\n    component: component,\n    rawOptions // includes type and component too :(\n  };\n}\nfunction createViewHookComponent(options) {\n  return viewProps => createElement(ViewContextType.Consumer, null, context => createElement(ContentContainer, {\n    elTag: \"div\",\n    elClasses: buildViewClassNames(context.viewSpec),\n    renderProps: Object.assign(Object.assign({}, viewProps), {\n      nextDayThreshold: context.options.nextDayThreshold\n    }),\n    generatorName: undefined,\n    customGenerator: options.content,\n    classNameGenerator: options.classNames,\n    didMount: options.didMount,\n    willUnmount: options.willUnmount\n  }));\n}\nfunction buildViewSpecs(defaultInputs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n  let defaultConfigs = parseViewConfigs(defaultInputs);\n  let overrideConfigs = parseViewConfigs(optionOverrides.views);\n  let viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n  return mapHash(viewDefs, viewDef => buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults));\n}\nfunction buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\n  let durationInput = viewDef.overrides.duration || viewDef.defaults.duration || dynamicOptionOverrides.duration || optionOverrides.duration;\n  let duration = null;\n  let durationUnit = '';\n  let singleUnit = '';\n  let singleUnitOverrides = {};\n  if (durationInput) {\n    duration = createDurationCached(durationInput);\n    if (duration) {\n      // valid?\n      let denom = greatestDurationDenominator(duration);\n      durationUnit = denom.unit;\n      if (denom.value === 1) {\n        singleUnit = durationUnit;\n        singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].rawOptions : {};\n      }\n    }\n  }\n  let queryButtonText = optionsSubset => {\n    let buttonTextMap = optionsSubset.buttonText || {};\n    let buttonTextKey = viewDef.defaults.buttonTextKey;\n    if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n      return buttonTextMap[buttonTextKey];\n    }\n    if (buttonTextMap[viewDef.type] != null) {\n      return buttonTextMap[viewDef.type];\n    }\n    if (buttonTextMap[singleUnit] != null) {\n      return buttonTextMap[singleUnit];\n    }\n    return null;\n  };\n  let queryButtonTitle = optionsSubset => {\n    let buttonHints = optionsSubset.buttonHints || {};\n    let buttonKey = viewDef.defaults.buttonTextKey; // use same key as text\n    if (buttonKey != null && buttonHints[buttonKey] != null) {\n      return buttonHints[buttonKey];\n    }\n    if (buttonHints[viewDef.type] != null) {\n      return buttonHints[viewDef.type];\n    }\n    if (buttonHints[singleUnit] != null) {\n      return buttonHints[singleUnit];\n    }\n    return null;\n  };\n  return {\n    type: viewDef.type,\n    component: viewDef.component,\n    duration,\n    durationUnit,\n    singleUnit,\n    optionDefaults: viewDef.defaults,\n    optionOverrides: Object.assign(Object.assign({}, singleUnitOverrides), viewDef.overrides),\n    buttonTextOverride: queryButtonText(dynamicOptionOverrides) || queryButtonText(optionOverrides) ||\n    // constructor-specified buttonText lookup hash takes precedence\n    viewDef.overrides.buttonText,\n    buttonTextDefault: queryButtonText(localeDefaults) || viewDef.defaults.buttonText || queryButtonText(BASE_OPTION_DEFAULTS) || viewDef.type,\n    // not DRY\n    buttonTitleOverride: queryButtonTitle(dynamicOptionOverrides) || queryButtonTitle(optionOverrides) || viewDef.overrides.buttonHint,\n    buttonTitleDefault: queryButtonTitle(localeDefaults) || viewDef.defaults.buttonHint || queryButtonTitle(BASE_OPTION_DEFAULTS)\n    // will eventually fall back to buttonText\n  };\n}\n// hack to get memoization working\nlet durationInputMap = {};\nfunction createDurationCached(durationInput) {\n  let json = JSON.stringify(durationInput);\n  let res = durationInputMap[json];\n  if (res === undefined) {\n    res = createDuration(durationInput);\n    durationInputMap[json] = res;\n  }\n  return res;\n}\nfunction reduceViewType(viewType, action) {\n  switch (action.type) {\n    case 'CHANGE_VIEW_TYPE':\n      viewType = action.viewType;\n  }\n  return viewType;\n}\nfunction reduceDynamicOptionOverrides(dynamicOptionOverrides, action) {\n  switch (action.type) {\n    case 'SET_OPTION':\n      return Object.assign(Object.assign({}, dynamicOptionOverrides), {\n        [action.optionName]: action.rawOptionValue\n      });\n    default:\n      return dynamicOptionOverrides;\n  }\n}\nfunction reduceDateProfile(currentDateProfile, action, currentDate, dateProfileGenerator) {\n  let dp;\n  switch (action.type) {\n    case 'CHANGE_VIEW_TYPE':\n      return dateProfileGenerator.build(action.dateMarker || currentDate);\n    case 'CHANGE_DATE':\n      return dateProfileGenerator.build(action.dateMarker);\n    case 'PREV':\n      dp = dateProfileGenerator.buildPrev(currentDateProfile, currentDate);\n      if (dp.isValid) {\n        return dp;\n      }\n      break;\n    case 'NEXT':\n      dp = dateProfileGenerator.buildNext(currentDateProfile, currentDate);\n      if (dp.isValid) {\n        return dp;\n      }\n      break;\n  }\n  return currentDateProfile;\n}\nfunction initEventSources(calendarOptions, dateProfile, context) {\n  let activeRange = dateProfile ? dateProfile.activeRange : null;\n  return addSources({}, parseInitialSources(calendarOptions, context), activeRange, context);\n}\nfunction reduceEventSources(eventSources, action, dateProfile, context) {\n  let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n  switch (action.type) {\n    case 'ADD_EVENT_SOURCES':\n      // already parsed\n      return addSources(eventSources, action.sources, activeRange, context);\n    case 'REMOVE_EVENT_SOURCE':\n      return removeSource(eventSources, action.sourceId);\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n    case 'NEXT':\n    case 'CHANGE_DATE':\n    case 'CHANGE_VIEW_TYPE':\n      if (dateProfile) {\n        return fetchDirtySources(eventSources, activeRange, context);\n      }\n      return eventSources;\n    case 'FETCH_EVENT_SOURCES':\n      return fetchSourcesByIds(eventSources, action.sourceIds ?\n      // why no type?\n      arrayToHash(action.sourceIds) : excludeStaticSources(eventSources, context), activeRange, action.isRefetch || false, context);\n    case 'RECEIVE_EVENTS':\n    case 'RECEIVE_EVENT_ERROR':\n      return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return {};\n    default:\n      return eventSources;\n  }\n}\nfunction reduceEventSourcesNewTimeZone(eventSources, dateProfile, context) {\n  let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\n  return fetchSourcesByIds(eventSources, excludeStaticSources(eventSources, context), activeRange, true, context);\n}\nfunction computeEventSourcesLoading(eventSources) {\n  for (let sourceId in eventSources) {\n    if (eventSources[sourceId].isFetching) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction addSources(eventSourceHash, sources, fetchRange, context) {\n  let hash = {};\n  for (let source of sources) {\n    hash[source.sourceId] = source;\n  }\n  if (fetchRange) {\n    hash = fetchDirtySources(hash, fetchRange, context);\n  }\n  return Object.assign(Object.assign({}, eventSourceHash), hash);\n}\nfunction removeSource(eventSourceHash, sourceId) {\n  return filterHash(eventSourceHash, eventSource => eventSource.sourceId !== sourceId);\n}\nfunction fetchDirtySources(sourceHash, fetchRange, context) {\n  return fetchSourcesByIds(sourceHash, filterHash(sourceHash, eventSource => isSourceDirty(eventSource, fetchRange, context)), fetchRange, false, context);\n}\nfunction isSourceDirty(eventSource, fetchRange, context) {\n  if (!doesSourceNeedRange(eventSource, context)) {\n    return !eventSource.latestFetchId;\n  }\n  return !context.options.lazyFetching || !eventSource.fetchRange || eventSource.isFetching ||\n  // always cancel outdated in-progress fetches\n  fetchRange.start < eventSource.fetchRange.start || fetchRange.end > eventSource.fetchRange.end;\n}\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, isRefetch, context) {\n  let nextSources = {};\n  for (let sourceId in prevSources) {\n    let source = prevSources[sourceId];\n    if (sourceIdHash[sourceId]) {\n      nextSources[sourceId] = fetchSource(source, fetchRange, isRefetch, context);\n    } else {\n      nextSources[sourceId] = source;\n    }\n  }\n  return nextSources;\n}\nfunction fetchSource(eventSource, fetchRange, isRefetch, context) {\n  let {\n    options,\n    calendarApi\n  } = context;\n  let sourceDef = context.pluginHooks.eventSourceDefs[eventSource.sourceDefId];\n  let fetchId = guid();\n  sourceDef.fetch({\n    eventSource,\n    range: fetchRange,\n    isRefetch,\n    context\n  }, res => {\n    let {\n      rawEvents\n    } = res;\n    if (options.eventSourceSuccess) {\n      rawEvents = options.eventSourceSuccess.call(calendarApi, rawEvents, res.response) || rawEvents;\n    }\n    if (eventSource.success) {\n      rawEvents = eventSource.success.call(calendarApi, rawEvents, res.response) || rawEvents;\n    }\n    context.dispatch({\n      type: 'RECEIVE_EVENTS',\n      sourceId: eventSource.sourceId,\n      fetchId,\n      fetchRange,\n      rawEvents\n    });\n  }, error => {\n    let errorHandled = false;\n    if (options.eventSourceFailure) {\n      options.eventSourceFailure.call(calendarApi, error);\n      errorHandled = true;\n    }\n    if (eventSource.failure) {\n      eventSource.failure(error);\n      errorHandled = true;\n    }\n    if (!errorHandled) {\n      console.warn(error.message, error);\n    }\n    context.dispatch({\n      type: 'RECEIVE_EVENT_ERROR',\n      sourceId: eventSource.sourceId,\n      fetchId,\n      fetchRange,\n      error\n    });\n  });\n  return Object.assign(Object.assign({}, eventSource), {\n    isFetching: true,\n    latestFetchId: fetchId\n  });\n}\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n  let eventSource = sourceHash[sourceId];\n  if (eventSource &&\n  // not already removed\n  fetchId === eventSource.latestFetchId) {\n    return Object.assign(Object.assign({}, sourceHash), {\n      [sourceId]: Object.assign(Object.assign({}, eventSource), {\n        isFetching: false,\n        fetchRange\n      })\n    });\n  }\n  return sourceHash;\n}\nfunction excludeStaticSources(eventSources, context) {\n  return filterHash(eventSources, eventSource => doesSourceNeedRange(eventSource, context));\n}\nfunction parseInitialSources(rawOptions, context) {\n  let refiners = buildEventSourceRefiners(context);\n  let rawSources = [].concat(rawOptions.eventSources || []);\n  let sources = []; // parsed\n  if (rawOptions.initialEvents) {\n    rawSources.unshift(rawOptions.initialEvents);\n  }\n  if (rawOptions.events) {\n    rawSources.unshift(rawOptions.events);\n  }\n  for (let rawSource of rawSources) {\n    let source = parseEventSource(rawSource, context, refiners);\n    if (source) {\n      sources.push(source);\n    }\n  }\n  return sources;\n}\nfunction doesSourceNeedRange(eventSource, context) {\n  let defs = context.pluginHooks.eventSourceDefs;\n  return !defs[eventSource.sourceDefId].ignoreRange;\n}\nfunction reduceDateSelection(currentSelection, action) {\n  switch (action.type) {\n    case 'UNSELECT_DATES':\n      return null;\n    case 'SELECT_DATES':\n      return action.selection;\n    default:\n      return currentSelection;\n  }\n}\nfunction reduceSelectedEvent(currentInstanceId, action) {\n  switch (action.type) {\n    case 'UNSELECT_EVENT':\n      return '';\n    case 'SELECT_EVENT':\n      return action.eventInstanceId;\n    default:\n      return currentInstanceId;\n  }\n}\nfunction reduceEventDrag(currentDrag, action) {\n  let newDrag;\n  switch (action.type) {\n    case 'UNSET_EVENT_DRAG':\n      return null;\n    case 'SET_EVENT_DRAG':\n      newDrag = action.state;\n      return {\n        affectedEvents: newDrag.affectedEvents,\n        mutatedEvents: newDrag.mutatedEvents,\n        isEvent: newDrag.isEvent\n      };\n    default:\n      return currentDrag;\n  }\n}\nfunction reduceEventResize(currentResize, action) {\n  let newResize;\n  switch (action.type) {\n    case 'UNSET_EVENT_RESIZE':\n      return null;\n    case 'SET_EVENT_RESIZE':\n      newResize = action.state;\n      return {\n        affectedEvents: newResize.affectedEvents,\n        mutatedEvents: newResize.mutatedEvents,\n        isEvent: newResize.isEvent\n      };\n    default:\n      return currentResize;\n  }\n}\nfunction parseToolbars(calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n  let header = calendarOptions.headerToolbar ? parseToolbar(calendarOptions.headerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n  let footer = calendarOptions.footerToolbar ? parseToolbar(calendarOptions.footerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\n  return {\n    header,\n    footer\n  };\n}\nfunction parseToolbar(sectionStrHash, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\n  let sectionWidgets = {};\n  let viewsWithButtons = [];\n  let hasTitle = false;\n  for (let sectionName in sectionStrHash) {\n    let sectionStr = sectionStrHash[sectionName];\n    let sectionRes = parseSection(sectionStr, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi);\n    sectionWidgets[sectionName] = sectionRes.widgets;\n    viewsWithButtons.push(...sectionRes.viewsWithButtons);\n    hasTitle = hasTitle || sectionRes.hasTitle;\n  }\n  return {\n    sectionWidgets,\n    viewsWithButtons,\n    hasTitle\n  };\n}\n/*\r\nBAD: querying icons and text here. should be done at render time\r\n*/\nfunction parseSection(sectionStr, calendarOptions,\n// defaults+overrides, then refined\ncalendarOptionOverrides,\n// overrides only!, unrefined :(\ntheme, viewSpecs, calendarApi) {\n  let isRtl = calendarOptions.direction === 'rtl';\n  let calendarCustomButtons = calendarOptions.customButtons || {};\n  let calendarButtonTextOverrides = calendarOptionOverrides.buttonText || {};\n  let calendarButtonText = calendarOptions.buttonText || {};\n  let calendarButtonHintOverrides = calendarOptionOverrides.buttonHints || {};\n  let calendarButtonHints = calendarOptions.buttonHints || {};\n  let sectionSubstrs = sectionStr ? sectionStr.split(' ') : [];\n  let viewsWithButtons = [];\n  let hasTitle = false;\n  let widgets = sectionSubstrs.map(buttonGroupStr => buttonGroupStr.split(',').map(buttonName => {\n    if (buttonName === 'title') {\n      hasTitle = true;\n      return {\n        buttonName\n      };\n    }\n    let customButtonProps;\n    let viewSpec;\n    let buttonClick;\n    let buttonIcon; // only one of these will be set\n    let buttonText; // \"\n    let buttonHint;\n    // ^ for the title=\"\" attribute, for accessibility\n    if (customButtonProps = calendarCustomButtons[buttonName]) {\n      buttonClick = ev => {\n        if (customButtonProps.click) {\n          customButtonProps.click.call(ev.target, ev, ev.target); // TODO: use Calendar this context?\n        }\n      };\n      (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = customButtonProps.text);\n      buttonHint = customButtonProps.hint || customButtonProps.text;\n    } else if (viewSpec = viewSpecs[buttonName]) {\n      viewsWithButtons.push(buttonName);\n      buttonClick = () => {\n        calendarApi.changeView(buttonName);\n      };\n      (buttonText = viewSpec.buttonTextOverride) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = viewSpec.buttonTextDefault);\n      let textFallback = viewSpec.buttonTextOverride || viewSpec.buttonTextDefault;\n      buttonHint = formatWithOrdinals(viewSpec.buttonTitleOverride || viewSpec.buttonTitleDefault || calendarOptions.viewHint, [textFallback, buttonName],\n      // view-name = buttonName\n      textFallback);\n    } else if (calendarApi[buttonName]) {\n      // a calendarApi method\n      buttonClick = () => {\n        calendarApi[buttonName]();\n      };\n      (buttonText = calendarButtonTextOverrides[buttonName]) || (buttonIcon = theme.getIconClass(buttonName, isRtl)) || (buttonText = calendarButtonText[buttonName]); // everything else is considered default\n      if (buttonName === 'prevYear' || buttonName === 'nextYear') {\n        let prevOrNext = buttonName === 'prevYear' ? 'prev' : 'next';\n        buttonHint = formatWithOrdinals(calendarButtonHintOverrides[prevOrNext] || calendarButtonHints[prevOrNext], [calendarButtonText.year || 'year', 'year'], calendarButtonText[buttonName]);\n      } else {\n        buttonHint = navUnit => formatWithOrdinals(calendarButtonHintOverrides[buttonName] || calendarButtonHints[buttonName], [calendarButtonText[navUnit] || navUnit, navUnit], calendarButtonText[buttonName]);\n      }\n    }\n    return {\n      buttonName,\n      buttonClick,\n      buttonIcon,\n      buttonText,\n      buttonHint\n    };\n  }));\n  return {\n    widgets,\n    viewsWithButtons,\n    hasTitle\n  };\n}\n\n// always represents the current view. otherwise, it'd need to change value every time date changes\nclass ViewImpl {\n  constructor(type, getCurrentData, dateEnv) {\n    this.type = type;\n    this.getCurrentData = getCurrentData;\n    this.dateEnv = dateEnv;\n  }\n  get calendar() {\n    return this.getCurrentData().calendarApi;\n  }\n  get title() {\n    return this.getCurrentData().viewTitle;\n  }\n  get activeStart() {\n    return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start);\n  }\n  get activeEnd() {\n    return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end);\n  }\n  get currentStart() {\n    return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start);\n  }\n  get currentEnd() {\n    return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end);\n  }\n  getOption(name) {\n    return this.getCurrentData().options[name]; // are the view-specific options\n  }\n}\nlet eventSourceDef$2 = {\n  ignoreRange: true,\n  parseMeta(refined) {\n    if (Array.isArray(refined.events)) {\n      return refined.events;\n    }\n    return null;\n  },\n  fetch(arg, successCallback) {\n    successCallback({\n      rawEvents: arg.eventSource.meta\n    });\n  }\n};\nconst arrayEventSourcePlugin = createPlugin({\n  name: 'array-event-source',\n  eventSourceDefs: [eventSourceDef$2]\n});\nlet eventSourceDef$1 = {\n  parseMeta(refined) {\n    if (typeof refined.events === 'function') {\n      return refined.events;\n    }\n    return null;\n  },\n  fetch(arg, successCallback, errorCallback) {\n    const {\n      dateEnv\n    } = arg.context;\n    const func = arg.eventSource.meta;\n    unpromisify(func.bind(null, buildRangeApiWithTimeZone(arg.range, dateEnv)), rawEvents => successCallback({\n      rawEvents\n    }), errorCallback);\n  }\n};\nconst funcEventSourcePlugin = createPlugin({\n  name: 'func-event-source',\n  eventSourceDefs: [eventSourceDef$1]\n});\nconst JSON_FEED_EVENT_SOURCE_REFINERS = {\n  method: String,\n  extraParams: identity,\n  startParam: String,\n  endParam: String,\n  timeZoneParam: String\n};\nlet eventSourceDef = {\n  parseMeta(refined) {\n    if (refined.url && (refined.format === 'json' || !refined.format)) {\n      return {\n        url: refined.url,\n        format: 'json',\n        method: (refined.method || 'GET').toUpperCase(),\n        extraParams: refined.extraParams,\n        startParam: refined.startParam,\n        endParam: refined.endParam,\n        timeZoneParam: refined.timeZoneParam\n      };\n    }\n    return null;\n  },\n  fetch(arg, successCallback, errorCallback) {\n    const {\n      meta\n    } = arg.eventSource;\n    const requestParams = buildRequestParams(meta, arg.range, arg.context);\n    requestJson(meta.method, meta.url, requestParams).then(_ref => {\n      let [rawEvents, response] = _ref;\n      successCallback({\n        rawEvents,\n        response\n      });\n    }, errorCallback);\n  }\n};\nconst jsonFeedEventSourcePlugin = createPlugin({\n  name: 'json-event-source',\n  eventSourceRefiners: JSON_FEED_EVENT_SOURCE_REFINERS,\n  eventSourceDefs: [eventSourceDef]\n});\nfunction buildRequestParams(meta, range, context) {\n  let {\n    dateEnv,\n    options\n  } = context;\n  let startParam;\n  let endParam;\n  let timeZoneParam;\n  let customRequestParams;\n  let params = {};\n  startParam = meta.startParam;\n  if (startParam == null) {\n    startParam = options.startParam;\n  }\n  endParam = meta.endParam;\n  if (endParam == null) {\n    endParam = options.endParam;\n  }\n  timeZoneParam = meta.timeZoneParam;\n  if (timeZoneParam == null) {\n    timeZoneParam = options.timeZoneParam;\n  }\n  // retrieve any outbound GET/POST data from the options\n  if (typeof meta.extraParams === 'function') {\n    // supplied as a function that returns a key/value object\n    customRequestParams = meta.extraParams();\n  } else {\n    // probably supplied as a straight key/value object\n    customRequestParams = meta.extraParams || {};\n  }\n  Object.assign(params, customRequestParams);\n  params[startParam] = dateEnv.formatIso(range.start);\n  params[endParam] = dateEnv.formatIso(range.end);\n  if (dateEnv.timeZone !== 'local') {\n    params[timeZoneParam] = dateEnv.timeZone;\n  }\n  return params;\n}\nconst SIMPLE_RECURRING_REFINERS = {\n  daysOfWeek: identity,\n  startTime: createDuration,\n  endTime: createDuration,\n  duration: createDuration,\n  startRecur: identity,\n  endRecur: identity\n};\nlet recurring = {\n  parse(refined, dateEnv) {\n    if (refined.daysOfWeek || refined.startTime || refined.endTime || refined.startRecur || refined.endRecur) {\n      let recurringData = {\n        daysOfWeek: refined.daysOfWeek || null,\n        startTime: refined.startTime || null,\n        endTime: refined.endTime || null,\n        startRecur: refined.startRecur ? dateEnv.createMarker(refined.startRecur) : null,\n        endRecur: refined.endRecur ? dateEnv.createMarker(refined.endRecur) : null\n      };\n      let duration;\n      if (refined.duration) {\n        duration = refined.duration;\n      }\n      if (!duration && refined.startTime && refined.endTime) {\n        duration = subtractDurations(refined.endTime, refined.startTime);\n      }\n      return {\n        allDayGuess: Boolean(!refined.startTime && !refined.endTime),\n        duration,\n        typeData: recurringData // doesn't need endTime anymore but oh well\n      };\n    }\n    return null;\n  },\n  expand(typeData, framingRange, dateEnv) {\n    let clippedFramingRange = intersectRanges(framingRange, {\n      start: typeData.startRecur,\n      end: typeData.endRecur\n    });\n    if (clippedFramingRange) {\n      return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n    }\n    return [];\n  }\n};\nconst simpleRecurringEventsPlugin = createPlugin({\n  name: 'simple-recurring-event',\n  recurringTypes: [recurring],\n  eventRefiners: SIMPLE_RECURRING_REFINERS\n});\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n  let dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n  let dayMarker = startOfDay(framingRange.start);\n  let endMarker = framingRange.end;\n  let instanceStarts = [];\n  while (dayMarker < endMarker) {\n    let instanceStart;\n    // if everyday, or this particular day-of-week\n    if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n      if (startTime) {\n        instanceStart = dateEnv.add(dayMarker, startTime);\n      } else {\n        instanceStart = dayMarker;\n      }\n      instanceStarts.push(instanceStart);\n    }\n    dayMarker = addDays(dayMarker, 1);\n  }\n  return instanceStarts;\n}\nconst changeHandlerPlugin = createPlugin({\n  name: 'change-handler',\n  optionChangeHandlers: {\n    events(events, context) {\n      handleEventSources([events], context);\n    },\n    eventSources: handleEventSources\n  }\n});\n/*\r\nBUG: if `event` was supplied, all previously-given `eventSources` will be wiped out\r\n*/\nfunction handleEventSources(inputs, context) {\n  let unfoundSources = hashValuesToArray(context.getCurrentData().eventSources);\n  if (unfoundSources.length === 1 && inputs.length === 1 && Array.isArray(unfoundSources[0]._raw) && Array.isArray(inputs[0])) {\n    context.dispatch({\n      type: 'RESET_RAW_EVENTS',\n      sourceId: unfoundSources[0].sourceId,\n      rawEvents: inputs[0]\n    });\n    return;\n  }\n  let newInputs = [];\n  for (let input of inputs) {\n    let inputFound = false;\n    for (let i = 0; i < unfoundSources.length; i += 1) {\n      if (unfoundSources[i]._raw === input) {\n        unfoundSources.splice(i, 1); // delete\n        inputFound = true;\n        break;\n      }\n    }\n    if (!inputFound) {\n      newInputs.push(input);\n    }\n  }\n  for (let unfoundSource of unfoundSources) {\n    context.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: unfoundSource.sourceId\n    });\n  }\n  for (let newInput of newInputs) {\n    context.calendarApi.addEventSource(newInput);\n  }\n}\nfunction handleDateProfile(dateProfile, context) {\n  context.emitter.trigger('datesSet', Object.assign(Object.assign({}, buildRangeApiWithTimeZone(dateProfile.activeRange, context.dateEnv)), {\n    view: context.viewApi\n  }));\n}\nfunction handleEventStore(eventStore, context) {\n  let {\n    emitter\n  } = context;\n  if (emitter.hasHandlers('eventsSet')) {\n    emitter.trigger('eventsSet', buildEventApis(eventStore, context));\n  }\n}\n\n/*\r\nthis array is exposed on the root namespace so that UMD plugins can add to it.\r\nsee the rollup-bundles script.\r\n*/\nconst globalPlugins = [arrayEventSourcePlugin, funcEventSourcePlugin, jsonFeedEventSourcePlugin, simpleRecurringEventsPlugin, changeHandlerPlugin, createPlugin({\n  name: 'misc',\n  isLoadingFuncs: [state => computeEventSourcesLoading(state.eventSources)],\n  propSetHandlers: {\n    dateProfile: handleDateProfile,\n    eventStore: handleEventStore\n  }\n})];\nclass TaskRunner {\n  constructor(runTaskOption, drainedOption) {\n    this.runTaskOption = runTaskOption;\n    this.drainedOption = drainedOption;\n    this.queue = [];\n    this.delayedRunner = new DelayedRunner(this.drain.bind(this));\n  }\n  request(task, delay) {\n    this.queue.push(task);\n    this.delayedRunner.request(delay);\n  }\n  pause(scope) {\n    this.delayedRunner.pause(scope);\n  }\n  resume(scope, force) {\n    this.delayedRunner.resume(scope, force);\n  }\n  drain() {\n    let {\n      queue\n    } = this;\n    while (queue.length) {\n      let completedTasks = [];\n      let task;\n      while (task = queue.shift()) {\n        this.runTask(task);\n        completedTasks.push(task);\n      }\n      this.drained(completedTasks);\n    } // keep going, in case new tasks were added in the drained handler\n  }\n  runTask(task) {\n    if (this.runTaskOption) {\n      this.runTaskOption(task);\n    }\n  }\n  drained(completedTasks) {\n    if (this.drainedOption) {\n      this.drainedOption(completedTasks);\n    }\n  }\n}\n\n// Computes what the title at the top of the calendarApi should be for this view\nfunction buildTitle(dateProfile, viewOptions, dateEnv) {\n  let range;\n  // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n  if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n    range = dateProfile.currentRange;\n  } else {\n    // for day units or smaller, use the actual day range\n    range = dateProfile.activeRange;\n  }\n  return dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || buildTitleFormat(dateProfile)), {\n    isEndExclusive: dateProfile.isRangeAllDay,\n    defaultSeparator: viewOptions.titleRangeSeparator\n  });\n}\n// Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\nfunction buildTitleFormat(dateProfile) {\n  let {\n    currentRangeUnit\n  } = dateProfile;\n  if (currentRangeUnit === 'year') {\n    return {\n      year: 'numeric'\n    };\n  }\n  if (currentRangeUnit === 'month') {\n    return {\n      year: 'numeric',\n      month: 'long'\n    }; // like \"September 2014\"\n  }\n  let days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n  if (days !== null && days > 1) {\n    // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n    return {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    };\n  }\n  // one day. longer, like \"September 9 2014\"\n  return {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  };\n}\n\n// in future refactor, do the redux-style function(state=initial) for initial-state\n// also, whatever is happening in constructor, have it happen in action queue too\nclass CalendarDataManager {\n  constructor(props) {\n    this.computeCurrentViewData = memoize(this._computeCurrentViewData);\n    this.organizeRawLocales = memoize(organizeRawLocales);\n    this.buildLocale = memoize(buildLocale);\n    this.buildPluginHooks = buildBuildPluginHooks();\n    this.buildDateEnv = memoize(buildDateEnv$1);\n    this.buildTheme = memoize(buildTheme);\n    this.parseToolbars = memoize(parseToolbars);\n    this.buildViewSpecs = memoize(buildViewSpecs);\n    this.buildDateProfileGenerator = memoizeObjArg(buildDateProfileGenerator);\n    this.buildViewApi = memoize(buildViewApi);\n    this.buildViewUiProps = memoizeObjArg(buildViewUiProps);\n    this.buildEventUiBySource = memoize(buildEventUiBySource, isPropsEqual);\n    this.buildEventUiBases = memoize(buildEventUiBases);\n    this.parseContextBusinessHours = memoizeObjArg(parseContextBusinessHours);\n    this.buildTitle = memoize(buildTitle);\n    this.emitter = new Emitter();\n    this.actionRunner = new TaskRunner(this._handleAction.bind(this), this.updateData.bind(this));\n    this.currentCalendarOptionsInput = {};\n    this.currentCalendarOptionsRefined = {};\n    this.currentViewOptionsInput = {};\n    this.currentViewOptionsRefined = {};\n    this.currentCalendarOptionsRefiners = {};\n    this.optionsForRefining = [];\n    this.optionsForHandling = [];\n    this.getCurrentData = () => this.data;\n    this.dispatch = action => {\n      this.actionRunner.request(action); // protects against recursive calls to _handleAction\n    };\n    this.props = props;\n    this.actionRunner.pause();\n    let dynamicOptionOverrides = {};\n    let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n    let currentViewType = optionsData.calendarOptions.initialView || optionsData.pluginHooks.initialView;\n    let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\n    // wire things up\n    // TODO: not DRY\n    props.calendarApi.currentDataManager = this;\n    this.emitter.setThisContext(props.calendarApi);\n    this.emitter.setOptions(currentViewData.options);\n    let currentDate = getInitialDate(optionsData.calendarOptions, optionsData.dateEnv);\n    let dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n    if (!rangeContainsMarker(dateProfile.activeRange, currentDate)) {\n      currentDate = dateProfile.currentRange.start;\n    }\n    let calendarContext = {\n      dateEnv: optionsData.dateEnv,\n      options: optionsData.calendarOptions,\n      pluginHooks: optionsData.pluginHooks,\n      calendarApi: props.calendarApi,\n      dispatch: this.dispatch,\n      emitter: this.emitter,\n      getCurrentData: this.getCurrentData\n    };\n    // needs to be after setThisContext\n    for (let callback of optionsData.pluginHooks.contextInit) {\n      callback(calendarContext);\n    }\n    // NOT DRY\n    let eventSources = initEventSources(optionsData.calendarOptions, dateProfile, calendarContext);\n    let initialState = {\n      dynamicOptionOverrides,\n      currentViewType,\n      currentDate,\n      dateProfile,\n      businessHours: this.parseContextBusinessHours(calendarContext),\n      eventSources,\n      eventUiBases: {},\n      eventStore: createEmptyEventStore(),\n      renderableEventStore: createEmptyEventStore(),\n      dateSelection: null,\n      eventSelection: '',\n      eventDrag: null,\n      eventResize: null,\n      selectionConfig: this.buildViewUiProps(calendarContext).selectionConfig\n    };\n    let contextAndState = Object.assign(Object.assign({}, calendarContext), initialState);\n    for (let reducer of optionsData.pluginHooks.reducers) {\n      Object.assign(initialState, reducer(null, null, contextAndState));\n    }\n    if (computeIsLoading(initialState, calendarContext)) {\n      this.emitter.trigger('loading', true); // NOT DRY\n    }\n    this.state = initialState;\n    this.updateData();\n    this.actionRunner.resume();\n  }\n  resetOptions(optionOverrides, changedOptionNames) {\n    let {\n      props\n    } = this;\n    if (changedOptionNames === undefined) {\n      props.optionOverrides = optionOverrides;\n    } else {\n      props.optionOverrides = Object.assign(Object.assign({}, props.optionOverrides || {}), optionOverrides);\n      this.optionsForRefining.push(...changedOptionNames);\n    }\n    if (changedOptionNames === undefined || changedOptionNames.length) {\n      this.actionRunner.request({\n        type: 'NOTHING'\n      });\n    }\n  }\n  _handleAction(action) {\n    let {\n      props,\n      state,\n      emitter\n    } = this;\n    let dynamicOptionOverrides = reduceDynamicOptionOverrides(state.dynamicOptionOverrides, action);\n    let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\n    let currentViewType = reduceViewType(state.currentViewType, action);\n    let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\n    // wire things up\n    // TODO: not DRY\n    props.calendarApi.currentDataManager = this;\n    emitter.setThisContext(props.calendarApi);\n    emitter.setOptions(currentViewData.options);\n    let calendarContext = {\n      dateEnv: optionsData.dateEnv,\n      options: optionsData.calendarOptions,\n      pluginHooks: optionsData.pluginHooks,\n      calendarApi: props.calendarApi,\n      dispatch: this.dispatch,\n      emitter,\n      getCurrentData: this.getCurrentData\n    };\n    let {\n      currentDate,\n      dateProfile\n    } = state;\n    if (this.data && this.data.dateProfileGenerator !== currentViewData.dateProfileGenerator) {\n      // hack\n      dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\n    }\n    currentDate = reduceCurrentDate(currentDate, action);\n    dateProfile = reduceDateProfile(dateProfile, action, currentDate, currentViewData.dateProfileGenerator);\n    if (action.type === 'PREV' ||\n    // TODO: move this logic into DateProfileGenerator\n    action.type === 'NEXT' ||\n    // \"\n    !rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n      currentDate = dateProfile.currentRange.start;\n    }\n    let eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendarContext);\n    let eventStore = reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendarContext);\n    let isEventsLoading = computeEventSourcesLoading(eventSources); // BAD. also called in this func in computeIsLoading\n    let renderableEventStore = isEventsLoading && !currentViewData.options.progressiveEventRendering ? state.renderableEventStore || eventStore :\n    // try from previous state\n    eventStore;\n    let {\n      eventUiSingleBase,\n      selectionConfig\n    } = this.buildViewUiProps(calendarContext); // will memoize obj\n    let eventUiBySource = this.buildEventUiBySource(eventSources);\n    let eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n    let newState = {\n      dynamicOptionOverrides,\n      currentViewType,\n      currentDate,\n      dateProfile,\n      eventSources,\n      eventStore,\n      renderableEventStore,\n      selectionConfig,\n      eventUiBases,\n      businessHours: this.parseContextBusinessHours(calendarContext),\n      dateSelection: reduceDateSelection(state.dateSelection, action),\n      eventSelection: reduceSelectedEvent(state.eventSelection, action),\n      eventDrag: reduceEventDrag(state.eventDrag, action),\n      eventResize: reduceEventResize(state.eventResize, action)\n    };\n    let contextAndState = Object.assign(Object.assign({}, calendarContext), newState);\n    for (let reducer of optionsData.pluginHooks.reducers) {\n      Object.assign(newState, reducer(state, action, contextAndState)); // give the OLD state, for old value\n    }\n    let wasLoading = computeIsLoading(state, calendarContext);\n    let isLoading = computeIsLoading(newState, calendarContext);\n    // TODO: use propSetHandlers in plugin system\n    if (!wasLoading && isLoading) {\n      emitter.trigger('loading', true);\n    } else if (wasLoading && !isLoading) {\n      emitter.trigger('loading', false);\n    }\n    this.state = newState;\n    if (props.onAction) {\n      props.onAction(action);\n    }\n  }\n  updateData() {\n    let {\n      props,\n      state\n    } = this;\n    let oldData = this.data;\n    let optionsData = this.computeOptionsData(props.optionOverrides, state.dynamicOptionOverrides, props.calendarApi);\n    let currentViewData = this.computeCurrentViewData(state.currentViewType, optionsData, props.optionOverrides, state.dynamicOptionOverrides);\n    let data = this.data = Object.assign(Object.assign(Object.assign({\n      viewTitle: this.buildTitle(state.dateProfile, currentViewData.options, optionsData.dateEnv),\n      calendarApi: props.calendarApi,\n      dispatch: this.dispatch,\n      emitter: this.emitter,\n      getCurrentData: this.getCurrentData\n    }, optionsData), currentViewData), state);\n    let changeHandlers = optionsData.pluginHooks.optionChangeHandlers;\n    let oldCalendarOptions = oldData && oldData.calendarOptions;\n    let newCalendarOptions = optionsData.calendarOptions;\n    if (oldCalendarOptions && oldCalendarOptions !== newCalendarOptions) {\n      if (oldCalendarOptions.timeZone !== newCalendarOptions.timeZone) {\n        // hack\n        state.eventSources = data.eventSources = reduceEventSourcesNewTimeZone(data.eventSources, state.dateProfile, data);\n        state.eventStore = data.eventStore = rezoneEventStoreDates(data.eventStore, oldData.dateEnv, data.dateEnv);\n        state.renderableEventStore = data.renderableEventStore = rezoneEventStoreDates(data.renderableEventStore, oldData.dateEnv, data.dateEnv);\n      }\n      for (let optionName in changeHandlers) {\n        if (this.optionsForHandling.indexOf(optionName) !== -1 || oldCalendarOptions[optionName] !== newCalendarOptions[optionName]) {\n          changeHandlers[optionName](newCalendarOptions[optionName], data);\n        }\n      }\n    }\n    this.optionsForHandling = [];\n    if (props.onData) {\n      props.onData(data);\n    }\n  }\n  computeOptionsData(optionOverrides, dynamicOptionOverrides, calendarApi) {\n    // TODO: blacklist options that are handled by optionChangeHandlers\n    if (!this.optionsForRefining.length && optionOverrides === this.stableOptionOverrides && dynamicOptionOverrides === this.stableDynamicOptionOverrides) {\n      return this.stableCalendarOptionsData;\n    }\n    let {\n      refinedOptions,\n      pluginHooks,\n      localeDefaults,\n      availableLocaleData,\n      extra\n    } = this.processRawCalendarOptions(optionOverrides, dynamicOptionOverrides);\n    warnUnknownOptions(extra);\n    let dateEnv = this.buildDateEnv(refinedOptions.timeZone, refinedOptions.locale, refinedOptions.weekNumberCalculation, refinedOptions.firstDay, refinedOptions.weekText, pluginHooks, availableLocaleData, refinedOptions.defaultRangeSeparator);\n    let viewSpecs = this.buildViewSpecs(pluginHooks.views, this.stableOptionOverrides, this.stableDynamicOptionOverrides, localeDefaults);\n    let theme = this.buildTheme(refinedOptions, pluginHooks);\n    let toolbarConfig = this.parseToolbars(refinedOptions, this.stableOptionOverrides, theme, viewSpecs, calendarApi);\n    return this.stableCalendarOptionsData = {\n      calendarOptions: refinedOptions,\n      pluginHooks,\n      dateEnv,\n      viewSpecs,\n      theme,\n      toolbarConfig,\n      localeDefaults,\n      availableRawLocales: availableLocaleData.map\n    };\n  }\n  // always called from behind a memoizer\n  processRawCalendarOptions(optionOverrides, dynamicOptionOverrides) {\n    let {\n      locales,\n      locale\n    } = mergeRawOptions([BASE_OPTION_DEFAULTS, optionOverrides, dynamicOptionOverrides]);\n    let availableLocaleData = this.organizeRawLocales(locales);\n    let availableRawLocales = availableLocaleData.map;\n    let localeDefaults = this.buildLocale(locale || availableLocaleData.defaultCode, availableRawLocales).options;\n    let pluginHooks = this.buildPluginHooks(optionOverrides.plugins || [], globalPlugins);\n    let refiners = this.currentCalendarOptionsRefiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n    let extra = {};\n    let raw = mergeRawOptions([BASE_OPTION_DEFAULTS, localeDefaults, optionOverrides, dynamicOptionOverrides]);\n    let refined = {};\n    let currentRaw = this.currentCalendarOptionsInput;\n    let currentRefined = this.currentCalendarOptionsRefined;\n    let anyChanges = false;\n    for (let optionName in raw) {\n      if (this.optionsForRefining.indexOf(optionName) === -1 && (raw[optionName] === currentRaw[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && optionName in currentRaw && COMPLEX_OPTION_COMPARATORS[optionName](currentRaw[optionName], raw[optionName]))) {\n        refined[optionName] = currentRefined[optionName];\n      } else if (refiners[optionName]) {\n        refined[optionName] = refiners[optionName](raw[optionName]);\n        anyChanges = true;\n      } else {\n        extra[optionName] = currentRaw[optionName];\n      }\n    }\n    if (anyChanges) {\n      this.currentCalendarOptionsInput = raw;\n      this.currentCalendarOptionsRefined = refined;\n      this.stableOptionOverrides = optionOverrides;\n      this.stableDynamicOptionOverrides = dynamicOptionOverrides;\n    }\n    this.optionsForHandling.push(...this.optionsForRefining);\n    this.optionsForRefining = [];\n    return {\n      rawOptions: this.currentCalendarOptionsInput,\n      refinedOptions: this.currentCalendarOptionsRefined,\n      pluginHooks,\n      availableLocaleData,\n      localeDefaults,\n      extra\n    };\n  }\n  _computeCurrentViewData(viewType, optionsData, optionOverrides, dynamicOptionOverrides) {\n    let viewSpec = optionsData.viewSpecs[viewType];\n    if (!viewSpec) {\n      throw new Error(\"viewType \\\"\".concat(viewType, \"\\\" is not available. Please make sure you've loaded all neccessary plugins\"));\n    }\n    let {\n      refinedOptions,\n      extra\n    } = this.processRawViewOptions(viewSpec, optionsData.pluginHooks, optionsData.localeDefaults, optionOverrides, dynamicOptionOverrides);\n    warnUnknownOptions(extra);\n    let dateProfileGenerator = this.buildDateProfileGenerator({\n      dateProfileGeneratorClass: viewSpec.optionDefaults.dateProfileGeneratorClass,\n      duration: viewSpec.duration,\n      durationUnit: viewSpec.durationUnit,\n      usesMinMaxTime: viewSpec.optionDefaults.usesMinMaxTime,\n      dateEnv: optionsData.dateEnv,\n      calendarApi: this.props.calendarApi,\n      slotMinTime: refinedOptions.slotMinTime,\n      slotMaxTime: refinedOptions.slotMaxTime,\n      showNonCurrentDates: refinedOptions.showNonCurrentDates,\n      dayCount: refinedOptions.dayCount,\n      dateAlignment: refinedOptions.dateAlignment,\n      dateIncrement: refinedOptions.dateIncrement,\n      hiddenDays: refinedOptions.hiddenDays,\n      weekends: refinedOptions.weekends,\n      nowInput: refinedOptions.now,\n      validRangeInput: refinedOptions.validRange,\n      visibleRangeInput: refinedOptions.visibleRange,\n      fixedWeekCount: refinedOptions.fixedWeekCount\n    });\n    let viewApi = this.buildViewApi(viewType, this.getCurrentData, optionsData.dateEnv);\n    return {\n      viewSpec,\n      options: refinedOptions,\n      dateProfileGenerator,\n      viewApi\n    };\n  }\n  processRawViewOptions(viewSpec, pluginHooks, localeDefaults, optionOverrides, dynamicOptionOverrides) {\n    let raw = mergeRawOptions([BASE_OPTION_DEFAULTS, viewSpec.optionDefaults, localeDefaults, optionOverrides, viewSpec.optionOverrides, dynamicOptionOverrides]);\n    let refiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), VIEW_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\n    let refined = {};\n    let currentRaw = this.currentViewOptionsInput;\n    let currentRefined = this.currentViewOptionsRefined;\n    let anyChanges = false;\n    let extra = {};\n    for (let optionName in raw) {\n      if (raw[optionName] === currentRaw[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], currentRaw[optionName])) {\n        refined[optionName] = currentRefined[optionName];\n      } else {\n        if (raw[optionName] === this.currentCalendarOptionsInput[optionName] || COMPLEX_OPTION_COMPARATORS[optionName] && COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], this.currentCalendarOptionsInput[optionName])) {\n          if (optionName in this.currentCalendarOptionsRefined) {\n            // might be an \"extra\" prop\n            refined[optionName] = this.currentCalendarOptionsRefined[optionName];\n          }\n        } else if (refiners[optionName]) {\n          refined[optionName] = refiners[optionName](raw[optionName]);\n        } else {\n          extra[optionName] = raw[optionName];\n        }\n        anyChanges = true;\n      }\n    }\n    if (anyChanges) {\n      this.currentViewOptionsInput = raw;\n      this.currentViewOptionsRefined = refined;\n    }\n    return {\n      rawOptions: this.currentViewOptionsInput,\n      refinedOptions: this.currentViewOptionsRefined,\n      extra\n    };\n  }\n}\nfunction buildDateEnv$1(timeZone, explicitLocale, weekNumberCalculation, firstDay, weekText, pluginHooks, availableLocaleData, defaultSeparator) {\n  let locale = buildLocale(explicitLocale || availableLocaleData.defaultCode, availableLocaleData.map);\n  return new DateEnv({\n    calendarSystem: 'gregory',\n    timeZone,\n    namedTimeZoneImpl: pluginHooks.namedTimeZonedImpl,\n    locale,\n    weekNumberCalculation,\n    firstDay,\n    weekText,\n    cmdFormatter: pluginHooks.cmdFormatter,\n    defaultSeparator\n  });\n}\nfunction buildTheme(options, pluginHooks) {\n  let ThemeClass = pluginHooks.themeClasses[options.themeSystem] || StandardTheme;\n  return new ThemeClass(options);\n}\nfunction buildDateProfileGenerator(props) {\n  let DateProfileGeneratorClass = props.dateProfileGeneratorClass || DateProfileGenerator;\n  return new DateProfileGeneratorClass(props);\n}\nfunction buildViewApi(type, getCurrentData, dateEnv) {\n  return new ViewImpl(type, getCurrentData, dateEnv);\n}\nfunction buildEventUiBySource(eventSources) {\n  return mapHash(eventSources, eventSource => eventSource.ui);\n}\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n  let eventUiBases = {\n    '': eventUiSingleBase\n  };\n  for (let defId in eventDefs) {\n    let def = eventDefs[defId];\n    if (def.sourceId && eventUiBySource[def.sourceId]) {\n      eventUiBases[defId] = eventUiBySource[def.sourceId];\n    }\n  }\n  return eventUiBases;\n}\nfunction buildViewUiProps(calendarContext) {\n  let {\n    options\n  } = calendarContext;\n  return {\n    eventUiSingleBase: createEventUi({\n      display: options.eventDisplay,\n      editable: options.editable,\n      startEditable: options.eventStartEditable,\n      durationEditable: options.eventDurationEditable,\n      constraint: options.eventConstraint,\n      overlap: typeof options.eventOverlap === 'boolean' ? options.eventOverlap : undefined,\n      allow: options.eventAllow,\n      backgroundColor: options.eventBackgroundColor,\n      borderColor: options.eventBorderColor,\n      textColor: options.eventTextColor,\n      color: options.eventColor\n      // classNames: options.eventClassNames // render hook will handle this\n    }, calendarContext),\n    selectionConfig: createEventUi({\n      constraint: options.selectConstraint,\n      overlap: typeof options.selectOverlap === 'boolean' ? options.selectOverlap : undefined,\n      allow: options.selectAllow\n    }, calendarContext)\n  };\n}\nfunction computeIsLoading(state, context) {\n  for (let isLoadingFunc of context.pluginHooks.isLoadingFuncs) {\n    if (isLoadingFunc(state)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction parseContextBusinessHours(calendarContext) {\n  return parseBusinessHours(calendarContext.options.businessHours, calendarContext);\n}\nfunction warnUnknownOptions(options, viewName) {\n  for (let optionName in options) {\n    console.warn(\"Unknown option '\".concat(optionName, \"'\") + (viewName ? \" for view '\".concat(viewName, \"'\") : ''));\n  }\n}\nclass ToolbarSection extends BaseComponent {\n  render() {\n    let children = this.props.widgetGroups.map(widgetGroup => this.renderWidgetGroup(widgetGroup));\n    return createElement('div', {\n      className: 'fc-toolbar-chunk'\n    }, ...children);\n  }\n  renderWidgetGroup(widgetGroup) {\n    let {\n      props\n    } = this;\n    let {\n      theme\n    } = this.context;\n    let children = [];\n    let isOnlyButtons = true;\n    for (let widget of widgetGroup) {\n      let {\n        buttonName,\n        buttonClick,\n        buttonText,\n        buttonIcon,\n        buttonHint\n      } = widget;\n      if (buttonName === 'title') {\n        isOnlyButtons = false;\n        children.push(createElement(\"h2\", {\n          className: \"fc-toolbar-title\",\n          id: props.titleId\n        }, props.title));\n      } else {\n        let isPressed = buttonName === props.activeButton;\n        let isDisabled = !props.isTodayEnabled && buttonName === 'today' || !props.isPrevEnabled && buttonName === 'prev' || !props.isNextEnabled && buttonName === 'next';\n        let buttonClasses = [\"fc-\".concat(buttonName, \"-button\"), theme.getClass('button')];\n        if (isPressed) {\n          buttonClasses.push(theme.getClass('buttonActive'));\n        }\n        children.push(createElement(\"button\", {\n          type: \"button\",\n          title: typeof buttonHint === 'function' ? buttonHint(props.navUnit) : buttonHint,\n          disabled: isDisabled,\n          \"aria-pressed\": isPressed,\n          className: buttonClasses.join(' '),\n          onClick: buttonClick\n        }, buttonText || (buttonIcon ? createElement(\"span\", {\n          className: buttonIcon,\n          role: \"img\"\n        }) : '')));\n      }\n    }\n    if (children.length > 1) {\n      let groupClassName = isOnlyButtons && theme.getClass('buttonGroup') || '';\n      return createElement('div', {\n        className: groupClassName\n      }, ...children);\n    }\n    return children[0];\n  }\n}\nclass Toolbar extends BaseComponent {\n  render() {\n    let {\n      model,\n      extraClassName\n    } = this.props;\n    let forceLtr = false;\n    let startContent;\n    let endContent;\n    let sectionWidgets = model.sectionWidgets;\n    let centerContent = sectionWidgets.center;\n    if (sectionWidgets.left) {\n      forceLtr = true;\n      startContent = sectionWidgets.left;\n    } else {\n      startContent = sectionWidgets.start;\n    }\n    if (sectionWidgets.right) {\n      forceLtr = true;\n      endContent = sectionWidgets.right;\n    } else {\n      endContent = sectionWidgets.end;\n    }\n    let classNames = [extraClassName || '', 'fc-toolbar', forceLtr ? 'fc-toolbar-ltr' : ''];\n    return createElement(\"div\", {\n      className: classNames.join(' ')\n    }, this.renderSection('start', startContent || []), this.renderSection('center', centerContent || []), this.renderSection('end', endContent || []));\n  }\n  renderSection(key, widgetGroups) {\n    let {\n      props\n    } = this;\n    return createElement(ToolbarSection, {\n      key: key,\n      widgetGroups: widgetGroups,\n      title: props.title,\n      navUnit: props.navUnit,\n      activeButton: props.activeButton,\n      isTodayEnabled: props.isTodayEnabled,\n      isPrevEnabled: props.isPrevEnabled,\n      isNextEnabled: props.isNextEnabled,\n      titleId: props.titleId\n    });\n  }\n}\nclass ViewHarness extends BaseComponent {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      availableWidth: null\n    };\n    this.handleEl = el => {\n      this.el = el;\n      setRef(this.props.elRef, el);\n      this.updateAvailableWidth();\n    };\n    this.handleResize = () => {\n      this.updateAvailableWidth();\n    };\n  }\n  render() {\n    let {\n      props,\n      state\n    } = this;\n    let {\n      aspectRatio\n    } = props;\n    let classNames = ['fc-view-harness', aspectRatio || props.liquid || props.height ? 'fc-view-harness-active' // harness controls the height\n    : 'fc-view-harness-passive' // let the view do the height\n    ];\n    let height = '';\n    let paddingBottom = '';\n    if (aspectRatio) {\n      if (state.availableWidth !== null) {\n        height = state.availableWidth / aspectRatio;\n      } else {\n        // while waiting to know availableWidth, we can't set height to *zero*\n        // because will cause lots of unnecessary scrollbars within scrollgrid.\n        // BETTER: don't start rendering ANYTHING yet until we know container width\n        // NOTE: why not always use paddingBottom? Causes height oscillation (issue 5606)\n        paddingBottom = \"\".concat(1 / aspectRatio * 100, \"%\");\n      }\n    } else {\n      height = props.height || '';\n    }\n    return createElement(\"div\", {\n      \"aria-labelledby\": props.labeledById,\n      ref: this.handleEl,\n      className: classNames.join(' '),\n      style: {\n        height,\n        paddingBottom\n      }\n    }, props.children);\n  }\n  componentDidMount() {\n    this.context.addResizeHandler(this.handleResize);\n  }\n  componentWillUnmount() {\n    this.context.removeResizeHandler(this.handleResize);\n  }\n  updateAvailableWidth() {\n    if (this.el &&\n    // needed. but why?\n    this.props.aspectRatio // aspectRatio is the only height setting that needs availableWidth\n    ) {\n      this.setState({\n        availableWidth: this.el.offsetWidth\n      });\n    }\n  }\n}\n\n/*\r\nDetects when the user clicks on an event within a DateComponent\r\n*/\nclass EventClicking extends Interaction {\n  constructor(settings) {\n    super(settings);\n    this.handleSegClick = (ev, segEl) => {\n      let {\n        component\n      } = this;\n      let {\n        context\n      } = component;\n      let seg = getElSeg(segEl);\n      if (seg &&\n      // might be the <div> surrounding the more link\n      component.isValidSegDownEl(ev.target)) {\n        // our way to simulate a link click for elements that can't be <a> tags\n        // grab before trigger fired in case trigger trashes DOM thru rerendering\n        let hasUrlContainer = elementClosest(ev.target, '.fc-event-forced-url');\n        let url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n        context.emitter.trigger('eventClick', {\n          el: segEl,\n          event: new EventImpl(component.context, seg.eventRange.def, seg.eventRange.instance),\n          jsEvent: ev,\n          view: context.viewApi\n        });\n        if (url && !ev.defaultPrevented) {\n          window.location.href = url;\n        }\n      }\n    };\n    this.destroy = listenBySelector(settings.el, 'click', '.fc-event',\n    // on both fg and bg events\n    this.handleSegClick);\n  }\n}\n\n/*\r\nTriggers events and adds/removes core classNames when the user's pointer\r\nenters/leaves event-elements of a component.\r\n*/\nclass EventHovering extends Interaction {\n  constructor(settings) {\n    super(settings);\n    // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n    this.handleEventElRemove = el => {\n      if (el === this.currentSegEl) {\n        this.handleSegLeave(null, this.currentSegEl);\n      }\n    };\n    this.handleSegEnter = (ev, segEl) => {\n      if (getElSeg(segEl)) {\n        // TODO: better way to make sure not hovering over more+ link or its wrapper\n        this.currentSegEl = segEl;\n        this.triggerEvent('eventMouseEnter', ev, segEl);\n      }\n    };\n    this.handleSegLeave = (ev, segEl) => {\n      if (this.currentSegEl) {\n        this.currentSegEl = null;\n        this.triggerEvent('eventMouseLeave', ev, segEl);\n      }\n    };\n    this.removeHoverListeners = listenToHoverBySelector(settings.el, '.fc-event',\n    // on both fg and bg events\n    this.handleSegEnter, this.handleSegLeave);\n  }\n  destroy() {\n    this.removeHoverListeners();\n  }\n  triggerEvent(publicEvName, ev, segEl) {\n    let {\n      component\n    } = this;\n    let {\n      context\n    } = component;\n    let seg = getElSeg(segEl);\n    if (!ev || component.isValidSegDownEl(ev.target)) {\n      context.emitter.trigger(publicEvName, {\n        el: segEl,\n        event: new EventImpl(context, seg.eventRange.def, seg.eventRange.instance),\n        jsEvent: ev,\n        view: context.viewApi\n      });\n    }\n  }\n}\nclass CalendarContent extends PureComponent {\n  constructor() {\n    super(...arguments);\n    this.buildViewContext = memoize(buildViewContext);\n    this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n    this.buildToolbarProps = memoize(buildToolbarProps);\n    this.headerRef = createRef();\n    this.footerRef = createRef();\n    this.interactionsStore = {};\n    // eslint-disable-next-line\n    this.state = {\n      viewLabelId: getUniqueDomId()\n    };\n    // Component Registration\n    // -----------------------------------------------------------------------------------------------------------------\n    this.registerInteractiveComponent = (component, settingsInput) => {\n      let settings = parseInteractionSettings(component, settingsInput);\n      let DEFAULT_INTERACTIONS = [EventClicking, EventHovering];\n      let interactionClasses = DEFAULT_INTERACTIONS.concat(this.props.pluginHooks.componentInteractions);\n      let interactions = interactionClasses.map(TheInteractionClass => new TheInteractionClass(settings));\n      this.interactionsStore[component.uid] = interactions;\n      interactionSettingsStore[component.uid] = settings;\n    };\n    this.unregisterInteractiveComponent = component => {\n      let listeners = this.interactionsStore[component.uid];\n      if (listeners) {\n        for (let listener of listeners) {\n          listener.destroy();\n        }\n        delete this.interactionsStore[component.uid];\n      }\n      delete interactionSettingsStore[component.uid];\n    };\n    // Resizing\n    // -----------------------------------------------------------------------------------------------------------------\n    this.resizeRunner = new DelayedRunner(() => {\n      this.props.emitter.trigger('_resize', true); // should window resizes be considered \"forced\" ?\n      this.props.emitter.trigger('windowResize', {\n        view: this.props.viewApi\n      });\n    });\n    this.handleWindowResize = ev => {\n      let {\n        options\n      } = this.props;\n      if (options.handleWindowResize && ev.target === window // avoid jqui events\n      ) {\n        this.resizeRunner.request(options.windowResizeDelay);\n      }\n    };\n  }\n  /*\r\n  renders INSIDE of an outer div\r\n  */\n  render() {\n    let {\n      props\n    } = this;\n    let {\n      toolbarConfig,\n      options\n    } = props;\n    let toolbarProps = this.buildToolbarProps(props.viewSpec, props.dateProfile, props.dateProfileGenerator, props.currentDate, getNow(props.options.now, props.dateEnv),\n    // TODO: use NowTimer????\n    props.viewTitle);\n    let viewVGrow = false;\n    let viewHeight = '';\n    let viewAspectRatio;\n    if (props.isHeightAuto || props.forPrint) {\n      viewHeight = '';\n    } else if (options.height != null) {\n      viewVGrow = true;\n    } else if (options.contentHeight != null) {\n      viewHeight = options.contentHeight;\n    } else {\n      viewAspectRatio = Math.max(options.aspectRatio, 0.5); // prevent from getting too tall\n    }\n    let viewContext = this.buildViewContext(props.viewSpec, props.viewApi, props.options, props.dateProfileGenerator, props.dateEnv, props.theme, props.pluginHooks, props.dispatch, props.getCurrentData, props.emitter, props.calendarApi, this.registerInteractiveComponent, this.unregisterInteractiveComponent);\n    let viewLabelId = toolbarConfig.header && toolbarConfig.header.hasTitle ? this.state.viewLabelId : undefined;\n    return createElement(ViewContextType.Provider, {\n      value: viewContext\n    }, toolbarConfig.header && createElement(Toolbar, Object.assign({\n      ref: this.headerRef,\n      extraClassName: \"fc-header-toolbar\",\n      model: toolbarConfig.header,\n      titleId: viewLabelId\n    }, toolbarProps)), createElement(ViewHarness, {\n      liquid: viewVGrow,\n      height: viewHeight,\n      aspectRatio: viewAspectRatio,\n      labeledById: viewLabelId\n    }, this.renderView(props), this.buildAppendContent()), toolbarConfig.footer && createElement(Toolbar, Object.assign({\n      ref: this.footerRef,\n      extraClassName: \"fc-footer-toolbar\",\n      model: toolbarConfig.footer,\n      titleId: \"\"\n    }, toolbarProps)));\n  }\n  componentDidMount() {\n    let {\n      props\n    } = this;\n    this.calendarInteractions = props.pluginHooks.calendarInteractions.map(CalendarInteractionClass => new CalendarInteractionClass(props));\n    window.addEventListener('resize', this.handleWindowResize);\n    let {\n      propSetHandlers\n    } = props.pluginHooks;\n    for (let propName in propSetHandlers) {\n      propSetHandlers[propName](props[propName], props);\n    }\n  }\n  componentDidUpdate(prevProps) {\n    let {\n      props\n    } = this;\n    let {\n      propSetHandlers\n    } = props.pluginHooks;\n    for (let propName in propSetHandlers) {\n      if (props[propName] !== prevProps[propName]) {\n        propSetHandlers[propName](props[propName], props);\n      }\n    }\n  }\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.handleWindowResize);\n    this.resizeRunner.clear();\n    for (let interaction of this.calendarInteractions) {\n      interaction.destroy();\n    }\n    this.props.emitter.trigger('_unmount');\n  }\n  buildAppendContent() {\n    let {\n      props\n    } = this;\n    let children = props.pluginHooks.viewContainerAppends.map(buildAppendContent => buildAppendContent(props));\n    return createElement(Fragment, {}, ...children);\n  }\n  renderView(props) {\n    let {\n      pluginHooks\n    } = props;\n    let {\n      viewSpec\n    } = props;\n    let viewProps = {\n      dateProfile: props.dateProfile,\n      businessHours: props.businessHours,\n      eventStore: props.renderableEventStore,\n      eventUiBases: props.eventUiBases,\n      dateSelection: props.dateSelection,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize,\n      isHeightAuto: props.isHeightAuto,\n      forPrint: props.forPrint\n    };\n    let transformers = this.buildViewPropTransformers(pluginHooks.viewPropsTransformers);\n    for (let transformer of transformers) {\n      Object.assign(viewProps, transformer.transform(viewProps, props));\n    }\n    let ViewComponent = viewSpec.component;\n    return createElement(ViewComponent, Object.assign({}, viewProps));\n  }\n}\nfunction buildToolbarProps(viewSpec, dateProfile, dateProfileGenerator, currentDate, now, title) {\n  // don't force any date-profiles to valid date profiles (the `false`) so that we can tell if it's invalid\n  let todayInfo = dateProfileGenerator.build(now, undefined, false); // TODO: need `undefined` or else INFINITE LOOP for some reason\n  let prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate, false);\n  let nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate, false);\n  return {\n    title,\n    activeButton: viewSpec.type,\n    navUnit: viewSpec.singleUnit,\n    isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n    isPrevEnabled: prevInfo.isValid,\n    isNextEnabled: nextInfo.isValid\n  };\n}\n// Plugin\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildViewPropTransformers(theClasses) {\n  return theClasses.map(TheClass => new TheClass());\n}\nclass Calendar extends CalendarImpl {\n  constructor(el) {\n    let optionOverrides = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super();\n    this.isRendering = false;\n    this.isRendered = false;\n    this.currentClassNames = [];\n    this.customContentRenderId = 0;\n    this.handleAction = action => {\n      // actions we know we want to render immediately\n      switch (action.type) {\n        case 'SET_EVENT_DRAG':\n        case 'SET_EVENT_RESIZE':\n          this.renderRunner.tryDrain();\n      }\n    };\n    this.handleData = data => {\n      this.currentData = data;\n      this.renderRunner.request(data.calendarOptions.rerenderDelay);\n    };\n    this.handleRenderRequest = () => {\n      if (this.isRendering) {\n        this.isRendered = true;\n        let {\n          currentData\n        } = this;\n        flushSync(() => {\n          render(createElement(CalendarRoot, {\n            options: currentData.calendarOptions,\n            theme: currentData.theme,\n            emitter: currentData.emitter\n          }, (classNames, height, isHeightAuto, forPrint) => {\n            this.setClassNames(classNames);\n            this.setHeight(height);\n            return createElement(RenderId.Provider, {\n              value: this.customContentRenderId\n            }, createElement(CalendarContent, Object.assign({\n              isHeightAuto: isHeightAuto,\n              forPrint: forPrint\n            }, currentData)));\n          }), this.el);\n        });\n      } else if (this.isRendered) {\n        this.isRendered = false;\n        render(null, this.el);\n        this.setClassNames([]);\n        this.setHeight('');\n      }\n    };\n    ensureElHasStyles(el);\n    this.el = el;\n    this.renderRunner = new DelayedRunner(this.handleRenderRequest);\n    new CalendarDataManager({\n      optionOverrides,\n      calendarApi: this,\n      onAction: this.handleAction,\n      onData: this.handleData\n    });\n  }\n  render() {\n    let wasRendering = this.isRendering;\n    if (!wasRendering) {\n      this.isRendering = true;\n    } else {\n      this.customContentRenderId += 1;\n    }\n    this.renderRunner.request();\n    if (wasRendering) {\n      this.updateSize();\n    }\n  }\n  destroy() {\n    if (this.isRendering) {\n      this.isRendering = false;\n      this.renderRunner.request();\n    }\n  }\n  updateSize() {\n    flushSync(() => {\n      super.updateSize();\n    });\n  }\n  batchRendering(func) {\n    this.renderRunner.pause('batchRendering');\n    func();\n    this.renderRunner.resume('batchRendering');\n  }\n  pauseRendering() {\n    this.renderRunner.pause('pauseRendering');\n  }\n  resumeRendering() {\n    this.renderRunner.resume('pauseRendering', true);\n  }\n  resetOptions(optionOverrides, changedOptionNames) {\n    this.currentDataManager.resetOptions(optionOverrides, changedOptionNames);\n  }\n  setClassNames(classNames) {\n    if (!isArraysEqual(classNames, this.currentClassNames)) {\n      let {\n        classList\n      } = this.el;\n      for (let className of this.currentClassNames) {\n        classList.remove(className);\n      }\n      for (let className of classNames) {\n        classList.add(className);\n      }\n      this.currentClassNames = classNames;\n    }\n  }\n  setHeight(height) {\n    applyStyleProp(this.el, 'height', height);\n  }\n}\nfunction formatDate(dateInput) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let dateEnv = buildDateEnv(options);\n  let formatter = createFormatter(options);\n  let dateMeta = dateEnv.createMarkerMeta(dateInput);\n  if (!dateMeta) {\n    // TODO: warning?\n    return '';\n  }\n  return dateEnv.format(dateMeta.marker, formatter, {\n    forcedTzo: dateMeta.forcedTzo\n  });\n}\nfunction formatRange(startInput, endInput, options) {\n  let dateEnv = buildDateEnv(typeof options === 'object' && options ? options : {}); // pass in if non-null object\n  let formatter = createFormatter(options);\n  let startMeta = dateEnv.createMarkerMeta(startInput);\n  let endMeta = dateEnv.createMarkerMeta(endInput);\n  if (!startMeta || !endMeta) {\n    // TODO: warning?\n    return '';\n  }\n  return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n    forcedStartTzo: startMeta.forcedTzo,\n    forcedEndTzo: endMeta.forcedTzo,\n    isEndExclusive: options.isEndExclusive,\n    defaultSeparator: BASE_OPTION_DEFAULTS.defaultRangeSeparator\n  });\n}\n// TODO: more DRY and optimized\nfunction buildDateEnv(settings) {\n  let locale = buildLocale(settings.locale || 'en', organizeRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n  return new DateEnv(Object.assign(Object.assign({\n    timeZone: BASE_OPTION_DEFAULTS.timeZone,\n    calendarSystem: 'gregory'\n  }, settings), {\n    locale\n  }));\n}\n\n// HELPERS\n/*\r\nif nextDayThreshold is specified, slicing is done in an all-day fashion.\r\nyou can get nextDayThreshold from context.nextDayThreshold\r\n*/\nfunction sliceEvents(props, allDay) {\n  return sliceEventStore(props.eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? props.nextDayThreshold : null).fg;\n}\nconst version = '6.1.15';\nexport { Calendar, createPlugin, formatDate, formatRange, globalLocales, globalPlugins, sliceEvents, version };","map":{"version":3,"names":["m","mergeProps","g","guid","i","isArraysEqual","T","Theme","a","mapHash","B","BaseComponent","V","ViewContextType","C","ContentContainer","b","buildViewClassNames","c","greatestDurationDenominator","d","createDuration","e","BASE_OPTION_DEFAULTS","f","arrayToHash","h","filterHash","j","buildEventSourceRefiners","p","parseEventSource","k","formatWithOrdinals","u","unpromisify","l","buildRangeApiWithTimeZone","n","identity","r","requestJson","s","subtractDurations","o","intersectRanges","q","startOfDay","t","addDays","v","hashValuesToArray","w","buildEventApis","D","DelayedRunner","x","createFormatter","y","diffWholeDays","z","memoize","A","memoizeObjArg","E","isPropsEqual","F","Emitter","G","getInitialDate","H","rangeContainsMarker","I","createEmptyEventStore","J","reduceCurrentDate","K","reduceEventStore","L","rezoneEventStoreDates","M","mergeRawOptions","N","BASE_OPTION_REFINERS","O","CALENDAR_LISTENER_REFINERS","P","CALENDAR_OPTION_REFINERS","Q","COMPLEX_OPTION_COMPARATORS","R","VIEW_OPTION_REFINERS","S","DateEnv","U","DateProfileGenerator","W","createEventUi","X","parseBusinessHours","Y","setRef","Z","Interaction","_","getElSeg","$","elementClosest","a0","EventImpl","a1","listenBySelector","a2","listenToHoverBySelector","a3","PureComponent","a4","buildViewContext","a5","getUniqueDomId","a6","parseInteractionSettings","a7","interactionSettingsStore","a8","getNow","a9","CalendarImpl","aa","flushSync","ab","CalendarRoot","ac","RenderId","ad","ensureElHasStyles","ae","applyStyleProp","af","sliceEventStore","ag","JsonRequestError","createElement","createRef","Fragment","render","globalLocales","MINIMAL_RAW_EN_LOCALE","code","week","dow","doy","direction","buttonText","prev","next","prevYear","nextYear","year","today","month","day","list","weekText","weekTextLong","closeHint","timeHint","eventHint","allDayText","moreLinkText","noEventsText","RAW_EN_LOCALE","Object","assign","buttonHints","unit","concat","viewHint","navLinkHint","moreLinkHint","eventCnt","organizeRawLocales","explicitRawLocales","defaultCode","length","allRawLocales","rawLocaleMap","en","rawLocale","map","buildLocale","inputSingular","available","Array","isArray","parseLocale","queryLocale","codeArg","codes","raw","queryRawLocale","parts","toLocaleLowerCase","split","simpleId","slice","join","merged","simpleNumberFormat","Intl","NumberFormat","options","createPlugin","input","id","name","premiumReleaseDate","Date","undefined","deps","reducers","isLoadingFuncs","contextInit","eventRefiners","eventDefMemberAdders","eventSourceRefiners","isDraggableTransformers","eventDragMutationMassagers","eventDefMutationAppliers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","views","viewPropsTransformers","isPropsValid","externalDefTransforms","viewContainerAppends","eventDropTransformers","componentInteractions","calendarInteractions","themeClasses","eventSourceDefs","cmdFormatter","recurringTypes","namedTimeZonedImpl","initialView","elementDraggingImpl","optionChangeHandlers","scrollGridImpl","listenerRefiners","optionRefiners","propSetHandlers","buildPluginHooks","pluginDefs","globalDefs","currentPluginIds","hooks","addDefs","defs","def","pluginName","currentId","combineHooks","console","warn","buildBuildPluginHooks","currentOverrideDefs","currentGlobalDefs","currentHooks","overrideDefs","hooks0","hooks1","compareOptionalDates","date0","date1","Math","max","valueOf","StandardTheme","prototype","classes","root","tableCellShaded","buttonGroup","button","buttonActive","baseIconClass","iconClasses","close","rtlIconClasses","iconOverrideOption","iconOverrideCustomButtonOption","iconOverridePrefix","compileViewDefs","defaultConfigs","overrideConfigs","hash","viewType","ensureViewDef","viewDef","buildViewDef","defaultConfig","overrideConfig","queryProp","theComponent","superType","superDef","Error","component","type","defaults","rawOptions","overrides","parseViewConfigs","inputs","parseViewConfig","content","createViewHookComponent","viewProps","Consumer","context","elTag","elClasses","viewSpec","renderProps","nextDayThreshold","generatorName","customGenerator","classNameGenerator","classNames","didMount","willUnmount","buildViewSpecs","defaultInputs","optionOverrides","dynamicOptionOverrides","localeDefaults","viewDefs","buildViewSpec","durationInput","duration","durationUnit","singleUnit","singleUnitOverrides","createDurationCached","denom","value","queryButtonText","optionsSubset","buttonTextMap","buttonTextKey","queryButtonTitle","buttonKey","optionDefaults","buttonTextOverride","buttonTextDefault","buttonTitleOverride","buttonHint","buttonTitleDefault","durationInputMap","json","JSON","stringify","res","reduceViewType","action","reduceDynamicOptionOverrides","optionName","rawOptionValue","reduceDateProfile","currentDateProfile","currentDate","dateProfileGenerator","dp","build","dateMarker","buildPrev","isValid","buildNext","initEventSources","calendarOptions","dateProfile","activeRange","addSources","parseInitialSources","reduceEventSources","eventSources","sources","removeSource","sourceId","fetchDirtySources","fetchSourcesByIds","sourceIds","excludeStaticSources","isRefetch","receiveResponse","fetchId","fetchRange","reduceEventSourcesNewTimeZone","computeEventSourcesLoading","isFetching","eventSourceHash","source","eventSource","sourceHash","isSourceDirty","doesSourceNeedRange","latestFetchId","lazyFetching","start","end","prevSources","sourceIdHash","nextSources","fetchSource","calendarApi","sourceDef","pluginHooks","sourceDefId","fetch","range","rawEvents","eventSourceSuccess","call","response","success","dispatch","error","errorHandled","eventSourceFailure","failure","message","refiners","rawSources","initialEvents","unshift","events","rawSource","push","ignoreRange","reduceDateSelection","currentSelection","selection","reduceSelectedEvent","currentInstanceId","eventInstanceId","reduceEventDrag","currentDrag","newDrag","state","affectedEvents","mutatedEvents","isEvent","reduceEventResize","currentResize","newResize","parseToolbars","calendarOptionOverrides","theme","viewSpecs","header","headerToolbar","parseToolbar","footer","footerToolbar","sectionStrHash","sectionWidgets","viewsWithButtons","hasTitle","sectionName","sectionStr","sectionRes","parseSection","widgets","isRtl","calendarCustomButtons","customButtons","calendarButtonTextOverrides","calendarButtonText","calendarButtonHintOverrides","calendarButtonHints","sectionSubstrs","buttonGroupStr","buttonName","customButtonProps","buttonClick","buttonIcon","ev","click","target","getCustomButtonIconClass","getIconClass","text","hint","changeView","textFallback","prevOrNext","navUnit","ViewImpl","constructor","getCurrentData","dateEnv","calendar","title","viewTitle","activeStart","toDate","activeEnd","currentStart","currentRange","currentEnd","getOption","eventSourceDef$2","parseMeta","refined","arg","successCallback","meta","arrayEventSourcePlugin","eventSourceDef$1","errorCallback","func","bind","funcEventSourcePlugin","JSON_FEED_EVENT_SOURCE_REFINERS","method","String","extraParams","startParam","endParam","timeZoneParam","eventSourceDef","url","format","toUpperCase","requestParams","buildRequestParams","then","_ref","jsonFeedEventSourcePlugin","customRequestParams","params","formatIso","timeZone","SIMPLE_RECURRING_REFINERS","daysOfWeek","startTime","endTime","startRecur","endRecur","recurring","parse","recurringData","createMarker","allDayGuess","Boolean","typeData","expand","framingRange","clippedFramingRange","expandRanges","simpleRecurringEventsPlugin","dowHash","dayMarker","endMarker","instanceStarts","instanceStart","getUTCDay","add","changeHandlerPlugin","handleEventSources","unfoundSources","_raw","newInputs","inputFound","splice","unfoundSource","newInput","addEventSource","handleDateProfile","emitter","trigger","view","viewApi","handleEventStore","eventStore","hasHandlers","globalPlugins","TaskRunner","runTaskOption","drainedOption","queue","delayedRunner","drain","request","task","delay","pause","scope","resume","force","completedTasks","shift","runTask","drained","buildTitle","viewOptions","test","currentRangeUnit","formatRange","titleFormat","buildTitleFormat","isEndExclusive","isRangeAllDay","defaultSeparator","titleRangeSeparator","days","CalendarDataManager","props","computeCurrentViewData","_computeCurrentViewData","buildDateEnv","buildDateEnv$1","buildTheme","buildDateProfileGenerator","buildViewApi","buildViewUiProps","buildEventUiBySource","buildEventUiBases","parseContextBusinessHours","actionRunner","_handleAction","updateData","currentCalendarOptionsInput","currentCalendarOptionsRefined","currentViewOptionsInput","currentViewOptionsRefined","currentCalendarOptionsRefiners","optionsForRefining","optionsForHandling","data","optionsData","computeOptionsData","currentViewType","currentViewData","currentDataManager","setThisContext","setOptions","calendarContext","callback","initialState","businessHours","eventUiBases","renderableEventStore","dateSelection","eventSelection","eventDrag","eventResize","selectionConfig","contextAndState","reducer","computeIsLoading","resetOptions","changedOptionNames","isEventsLoading","progressiveEventRendering","eventUiSingleBase","eventUiBySource","newState","wasLoading","isLoading","onAction","oldData","changeHandlers","oldCalendarOptions","newCalendarOptions","indexOf","onData","stableOptionOverrides","stableDynamicOptionOverrides","stableCalendarOptionsData","refinedOptions","availableLocaleData","extra","processRawCalendarOptions","warnUnknownOptions","locale","weekNumberCalculation","firstDay","defaultRangeSeparator","toolbarConfig","availableRawLocales","locales","plugins","currentRaw","currentRefined","anyChanges","processRawViewOptions","dateProfileGeneratorClass","usesMinMaxTime","slotMinTime","slotMaxTime","showNonCurrentDates","dayCount","dateAlignment","dateIncrement","hiddenDays","weekends","nowInput","now","validRangeInput","validRange","visibleRangeInput","visibleRange","fixedWeekCount","explicitLocale","calendarSystem","namedTimeZoneImpl","ThemeClass","themeSystem","DateProfileGeneratorClass","ui","eventDefs","defId","display","eventDisplay","editable","startEditable","eventStartEditable","durationEditable","eventDurationEditable","constraint","eventConstraint","overlap","eventOverlap","allow","eventAllow","backgroundColor","eventBackgroundColor","borderColor","eventBorderColor","textColor","eventTextColor","color","eventColor","selectConstraint","selectOverlap","selectAllow","isLoadingFunc","viewName","ToolbarSection","children","widgetGroups","widgetGroup","renderWidgetGroup","className","isOnlyButtons","widget","titleId","isPressed","activeButton","isDisabled","isTodayEnabled","isPrevEnabled","isNextEnabled","buttonClasses","getClass","disabled","onClick","role","groupClassName","Toolbar","model","extraClassName","forceLtr","startContent","endContent","centerContent","center","left","right","renderSection","key","ViewHarness","arguments","availableWidth","handleEl","el","elRef","updateAvailableWidth","handleResize","aspectRatio","liquid","height","paddingBottom","labeledById","ref","style","componentDidMount","addResizeHandler","componentWillUnmount","removeResizeHandler","setState","offsetWidth","EventClicking","settings","handleSegClick","segEl","seg","isValidSegDownEl","hasUrlContainer","querySelector","href","event","eventRange","instance","jsEvent","defaultPrevented","window","location","destroy","EventHovering","handleEventElRemove","currentSegEl","handleSegLeave","handleSegEnter","triggerEvent","removeHoverListeners","publicEvName","CalendarContent","buildViewPropTransformers","buildToolbarProps","headerRef","footerRef","interactionsStore","viewLabelId","registerInteractiveComponent","settingsInput","DEFAULT_INTERACTIONS","interactionClasses","interactions","TheInteractionClass","uid","unregisterInteractiveComponent","listeners","listener","resizeRunner","handleWindowResize","windowResizeDelay","toolbarProps","viewVGrow","viewHeight","viewAspectRatio","isHeightAuto","forPrint","contentHeight","viewContext","Provider","renderView","buildAppendContent","CalendarInteractionClass","addEventListener","propName","componentDidUpdate","prevProps","removeEventListener","clear","interaction","transformers","transformer","transform","ViewComponent","todayInfo","prevInfo","nextInfo","theClasses","TheClass","Calendar","isRendering","isRendered","currentClassNames","customContentRenderId","handleAction","renderRunner","tryDrain","handleData","currentData","rerenderDelay","handleRenderRequest","setClassNames","setHeight","wasRendering","updateSize","batchRendering","pauseRendering","resumeRendering","classList","remove","formatDate","dateInput","formatter","dateMeta","createMarkerMeta","marker","forcedTzo","startInput","endInput","startMeta","endMeta","forcedStartTzo","forcedEndTzo","sliceEvents","allDay","fg","version"],"sources":["C:/Users/ADMIN/Desktop/clone/ENTNT_Assignment/frontend/node_modules/@fullcalendar/core/index.js"],"sourcesContent":["import { m as mergeProps, g as guid, i as isArraysEqual, T as Theme, a as mapHash, B as BaseComponent, V as ViewContextType, C as ContentContainer, b as buildViewClassNames, c as greatestDurationDenominator, d as createDuration, e as BASE_OPTION_DEFAULTS, f as arrayToHash, h as filterHash, j as buildEventSourceRefiners, p as parseEventSource, k as formatWithOrdinals, u as unpromisify, l as buildRangeApiWithTimeZone, n as identity, r as requestJson, s as subtractDurations, o as intersectRanges, q as startOfDay, t as addDays, v as hashValuesToArray, w as buildEventApis, D as DelayedRunner, x as createFormatter, y as diffWholeDays, z as memoize, A as memoizeObjArg, E as isPropsEqual, F as Emitter, G as getInitialDate, H as rangeContainsMarker, I as createEmptyEventStore, J as reduceCurrentDate, K as reduceEventStore, L as rezoneEventStoreDates, M as mergeRawOptions, N as BASE_OPTION_REFINERS, O as CALENDAR_LISTENER_REFINERS, P as CALENDAR_OPTION_REFINERS, Q as COMPLEX_OPTION_COMPARATORS, R as VIEW_OPTION_REFINERS, S as DateEnv, U as DateProfileGenerator, W as createEventUi, X as parseBusinessHours, Y as setRef, Z as Interaction, _ as getElSeg, $ as elementClosest, a0 as EventImpl, a1 as listenBySelector, a2 as listenToHoverBySelector, a3 as PureComponent, a4 as buildViewContext, a5 as getUniqueDomId, a6 as parseInteractionSettings, a7 as interactionSettingsStore, a8 as getNow, a9 as CalendarImpl, aa as flushSync, ab as CalendarRoot, ac as RenderId, ad as ensureElHasStyles, ae as applyStyleProp, af as sliceEventStore } from './internal-common.js';\r\nexport { ag as JsonRequestError } from './internal-common.js';\r\nimport { createElement, createRef, Fragment, render } from 'preact';\r\nimport 'preact/compat';\r\n\r\nconst globalLocales = [];\r\n\r\nconst MINIMAL_RAW_EN_LOCALE = {\r\n    code: 'en',\r\n    week: {\r\n        dow: 0,\r\n        doy: 4, // 4 days need to be within the year to be considered the first week\r\n    },\r\n    direction: 'ltr',\r\n    buttonText: {\r\n        prev: 'prev',\r\n        next: 'next',\r\n        prevYear: 'prev year',\r\n        nextYear: 'next year',\r\n        year: 'year',\r\n        today: 'today',\r\n        month: 'month',\r\n        week: 'week',\r\n        day: 'day',\r\n        list: 'list',\r\n    },\r\n    weekText: 'W',\r\n    weekTextLong: 'Week',\r\n    closeHint: 'Close',\r\n    timeHint: 'Time',\r\n    eventHint: 'Event',\r\n    allDayText: 'all-day',\r\n    moreLinkText: 'more',\r\n    noEventsText: 'No events to display',\r\n};\r\nconst RAW_EN_LOCALE = Object.assign(Object.assign({}, MINIMAL_RAW_EN_LOCALE), { \r\n    // Includes things we don't want other locales to inherit,\r\n    // things that derive from other translatable strings.\r\n    buttonHints: {\r\n        prev: 'Previous $0',\r\n        next: 'Next $0',\r\n        today(buttonText, unit) {\r\n            return (unit === 'day')\r\n                ? 'Today'\r\n                : `This ${buttonText}`;\r\n        },\r\n    }, viewHint: '$0 view', navLinkHint: 'Go to $0', moreLinkHint(eventCnt) {\r\n        return `Show ${eventCnt} more event${eventCnt === 1 ? '' : 's'}`;\r\n    } });\r\nfunction organizeRawLocales(explicitRawLocales) {\r\n    let defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\r\n    let allRawLocales = globalLocales.concat(explicitRawLocales);\r\n    let rawLocaleMap = {\r\n        en: RAW_EN_LOCALE,\r\n    };\r\n    for (let rawLocale of allRawLocales) {\r\n        rawLocaleMap[rawLocale.code] = rawLocale;\r\n    }\r\n    return {\r\n        map: rawLocaleMap,\r\n        defaultCode,\r\n    };\r\n}\r\nfunction buildLocale(inputSingular, available) {\r\n    if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\r\n        return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\r\n    }\r\n    return queryLocale(inputSingular, available);\r\n}\r\nfunction queryLocale(codeArg, available) {\r\n    let codes = [].concat(codeArg || []); // will convert to array\r\n    let raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\r\n    return parseLocale(codeArg, codes, raw);\r\n}\r\nfunction queryRawLocale(codes, available) {\r\n    for (let i = 0; i < codes.length; i += 1) {\r\n        let parts = codes[i].toLocaleLowerCase().split('-');\r\n        for (let j = parts.length; j > 0; j -= 1) {\r\n            let simpleId = parts.slice(0, j).join('-');\r\n            if (available[simpleId]) {\r\n                return available[simpleId];\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction parseLocale(codeArg, codes, raw) {\r\n    let merged = mergeProps([MINIMAL_RAW_EN_LOCALE, raw], ['buttonText']);\r\n    delete merged.code; // don't want this part of the options\r\n    let { week } = merged;\r\n    delete merged.week;\r\n    return {\r\n        codeArg,\r\n        codes,\r\n        week,\r\n        simpleNumberFormat: new Intl.NumberFormat(codeArg),\r\n        options: merged,\r\n    };\r\n}\r\n\r\n// TODO: easier way to add new hooks? need to update a million things\r\nfunction createPlugin(input) {\r\n    return {\r\n        id: guid(),\r\n        name: input.name,\r\n        premiumReleaseDate: input.premiumReleaseDate ? new Date(input.premiumReleaseDate) : undefined,\r\n        deps: input.deps || [],\r\n        reducers: input.reducers || [],\r\n        isLoadingFuncs: input.isLoadingFuncs || [],\r\n        contextInit: [].concat(input.contextInit || []),\r\n        eventRefiners: input.eventRefiners || {},\r\n        eventDefMemberAdders: input.eventDefMemberAdders || [],\r\n        eventSourceRefiners: input.eventSourceRefiners || {},\r\n        isDraggableTransformers: input.isDraggableTransformers || [],\r\n        eventDragMutationMassagers: input.eventDragMutationMassagers || [],\r\n        eventDefMutationAppliers: input.eventDefMutationAppliers || [],\r\n        dateSelectionTransformers: input.dateSelectionTransformers || [],\r\n        datePointTransforms: input.datePointTransforms || [],\r\n        dateSpanTransforms: input.dateSpanTransforms || [],\r\n        views: input.views || {},\r\n        viewPropsTransformers: input.viewPropsTransformers || [],\r\n        isPropsValid: input.isPropsValid || null,\r\n        externalDefTransforms: input.externalDefTransforms || [],\r\n        viewContainerAppends: input.viewContainerAppends || [],\r\n        eventDropTransformers: input.eventDropTransformers || [],\r\n        componentInteractions: input.componentInteractions || [],\r\n        calendarInteractions: input.calendarInteractions || [],\r\n        themeClasses: input.themeClasses || {},\r\n        eventSourceDefs: input.eventSourceDefs || [],\r\n        cmdFormatter: input.cmdFormatter,\r\n        recurringTypes: input.recurringTypes || [],\r\n        namedTimeZonedImpl: input.namedTimeZonedImpl,\r\n        initialView: input.initialView || '',\r\n        elementDraggingImpl: input.elementDraggingImpl,\r\n        optionChangeHandlers: input.optionChangeHandlers || {},\r\n        scrollGridImpl: input.scrollGridImpl || null,\r\n        listenerRefiners: input.listenerRefiners || {},\r\n        optionRefiners: input.optionRefiners || {},\r\n        propSetHandlers: input.propSetHandlers || {},\r\n    };\r\n}\r\nfunction buildPluginHooks(pluginDefs, globalDefs) {\r\n    let currentPluginIds = {};\r\n    let hooks = {\r\n        premiumReleaseDate: undefined,\r\n        reducers: [],\r\n        isLoadingFuncs: [],\r\n        contextInit: [],\r\n        eventRefiners: {},\r\n        eventDefMemberAdders: [],\r\n        eventSourceRefiners: {},\r\n        isDraggableTransformers: [],\r\n        eventDragMutationMassagers: [],\r\n        eventDefMutationAppliers: [],\r\n        dateSelectionTransformers: [],\r\n        datePointTransforms: [],\r\n        dateSpanTransforms: [],\r\n        views: {},\r\n        viewPropsTransformers: [],\r\n        isPropsValid: null,\r\n        externalDefTransforms: [],\r\n        viewContainerAppends: [],\r\n        eventDropTransformers: [],\r\n        componentInteractions: [],\r\n        calendarInteractions: [],\r\n        themeClasses: {},\r\n        eventSourceDefs: [],\r\n        cmdFormatter: null,\r\n        recurringTypes: [],\r\n        namedTimeZonedImpl: null,\r\n        initialView: '',\r\n        elementDraggingImpl: null,\r\n        optionChangeHandlers: {},\r\n        scrollGridImpl: null,\r\n        listenerRefiners: {},\r\n        optionRefiners: {},\r\n        propSetHandlers: {},\r\n    };\r\n    function addDefs(defs) {\r\n        for (let def of defs) {\r\n            const pluginName = def.name;\r\n            const currentId = currentPluginIds[pluginName];\r\n            if (currentId === undefined) {\r\n                currentPluginIds[pluginName] = def.id;\r\n                addDefs(def.deps);\r\n                hooks = combineHooks(hooks, def);\r\n            }\r\n            else if (currentId !== def.id) {\r\n                // different ID than the one already added\r\n                console.warn(`Duplicate plugin '${pluginName}'`);\r\n            }\r\n        }\r\n    }\r\n    if (pluginDefs) {\r\n        addDefs(pluginDefs);\r\n    }\r\n    addDefs(globalDefs);\r\n    return hooks;\r\n}\r\nfunction buildBuildPluginHooks() {\r\n    let currentOverrideDefs = [];\r\n    let currentGlobalDefs = [];\r\n    let currentHooks;\r\n    return (overrideDefs, globalDefs) => {\r\n        if (!currentHooks || !isArraysEqual(overrideDefs, currentOverrideDefs) || !isArraysEqual(globalDefs, currentGlobalDefs)) {\r\n            currentHooks = buildPluginHooks(overrideDefs, globalDefs);\r\n        }\r\n        currentOverrideDefs = overrideDefs;\r\n        currentGlobalDefs = globalDefs;\r\n        return currentHooks;\r\n    };\r\n}\r\nfunction combineHooks(hooks0, hooks1) {\r\n    return {\r\n        premiumReleaseDate: compareOptionalDates(hooks0.premiumReleaseDate, hooks1.premiumReleaseDate),\r\n        reducers: hooks0.reducers.concat(hooks1.reducers),\r\n        isLoadingFuncs: hooks0.isLoadingFuncs.concat(hooks1.isLoadingFuncs),\r\n        contextInit: hooks0.contextInit.concat(hooks1.contextInit),\r\n        eventRefiners: Object.assign(Object.assign({}, hooks0.eventRefiners), hooks1.eventRefiners),\r\n        eventDefMemberAdders: hooks0.eventDefMemberAdders.concat(hooks1.eventDefMemberAdders),\r\n        eventSourceRefiners: Object.assign(Object.assign({}, hooks0.eventSourceRefiners), hooks1.eventSourceRefiners),\r\n        isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\r\n        eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\r\n        eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\r\n        dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\r\n        datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\r\n        dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\r\n        views: Object.assign(Object.assign({}, hooks0.views), hooks1.views),\r\n        viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\r\n        isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\r\n        externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\r\n        viewContainerAppends: hooks0.viewContainerAppends.concat(hooks1.viewContainerAppends),\r\n        eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\r\n        calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\r\n        componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\r\n        themeClasses: Object.assign(Object.assign({}, hooks0.themeClasses), hooks1.themeClasses),\r\n        eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\r\n        cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\r\n        recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\r\n        namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\r\n        initialView: hooks0.initialView || hooks1.initialView,\r\n        elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\r\n        optionChangeHandlers: Object.assign(Object.assign({}, hooks0.optionChangeHandlers), hooks1.optionChangeHandlers),\r\n        scrollGridImpl: hooks1.scrollGridImpl || hooks0.scrollGridImpl,\r\n        listenerRefiners: Object.assign(Object.assign({}, hooks0.listenerRefiners), hooks1.listenerRefiners),\r\n        optionRefiners: Object.assign(Object.assign({}, hooks0.optionRefiners), hooks1.optionRefiners),\r\n        propSetHandlers: Object.assign(Object.assign({}, hooks0.propSetHandlers), hooks1.propSetHandlers),\r\n    };\r\n}\r\nfunction compareOptionalDates(date0, date1) {\r\n    if (date0 === undefined) {\r\n        return date1;\r\n    }\r\n    if (date1 === undefined) {\r\n        return date0;\r\n    }\r\n    return new Date(Math.max(date0.valueOf(), date1.valueOf()));\r\n}\r\n\r\nclass StandardTheme extends Theme {\r\n}\r\nStandardTheme.prototype.classes = {\r\n    root: 'fc-theme-standard',\r\n    tableCellShaded: 'fc-cell-shaded',\r\n    buttonGroup: 'fc-button-group',\r\n    button: 'fc-button fc-button-primary',\r\n    buttonActive: 'fc-button-active',\r\n};\r\nStandardTheme.prototype.baseIconClass = 'fc-icon';\r\nStandardTheme.prototype.iconClasses = {\r\n    close: 'fc-icon-x',\r\n    prev: 'fc-icon-chevron-left',\r\n    next: 'fc-icon-chevron-right',\r\n    prevYear: 'fc-icon-chevrons-left',\r\n    nextYear: 'fc-icon-chevrons-right',\r\n};\r\nStandardTheme.prototype.rtlIconClasses = {\r\n    prev: 'fc-icon-chevron-right',\r\n    next: 'fc-icon-chevron-left',\r\n    prevYear: 'fc-icon-chevrons-right',\r\n    nextYear: 'fc-icon-chevrons-left',\r\n};\r\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons'; // TODO: make TS-friendly\r\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\r\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\r\n\r\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\r\n    let hash = {};\r\n    let viewType;\r\n    for (viewType in defaultConfigs) {\r\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    for (viewType in overrideConfigs) {\r\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    return hash;\r\n}\r\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\r\n    if (hash[viewType]) {\r\n        return hash[viewType];\r\n    }\r\n    let viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    if (viewDef) {\r\n        hash[viewType] = viewDef;\r\n    }\r\n    return viewDef;\r\n}\r\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\r\n    let defaultConfig = defaultConfigs[viewType];\r\n    let overrideConfig = overrideConfigs[viewType];\r\n    let queryProp = (name) => ((defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\r\n        ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null));\r\n    let theComponent = queryProp('component');\r\n    let superType = queryProp('superType');\r\n    let superDef = null;\r\n    if (superType) {\r\n        if (superType === viewType) {\r\n            throw new Error('Can\\'t have a custom view type that references itself');\r\n        }\r\n        superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    if (!theComponent && superDef) {\r\n        theComponent = superDef.component;\r\n    }\r\n    if (!theComponent) {\r\n        return null; // don't throw a warning, might be settings for a single-unit view\r\n    }\r\n    return {\r\n        type: viewType,\r\n        component: theComponent,\r\n        defaults: Object.assign(Object.assign({}, (superDef ? superDef.defaults : {})), (defaultConfig ? defaultConfig.rawOptions : {})),\r\n        overrides: Object.assign(Object.assign({}, (superDef ? superDef.overrides : {})), (overrideConfig ? overrideConfig.rawOptions : {})),\r\n    };\r\n}\r\n\r\nfunction parseViewConfigs(inputs) {\r\n    return mapHash(inputs, parseViewConfig);\r\n}\r\nfunction parseViewConfig(input) {\r\n    let rawOptions = typeof input === 'function' ?\r\n        { component: input } :\r\n        input;\r\n    let { component } = rawOptions;\r\n    if (rawOptions.content) {\r\n        // TODO: remove content/classNames/didMount/etc from options?\r\n        component = createViewHookComponent(rawOptions);\r\n    }\r\n    else if (component && !(component.prototype instanceof BaseComponent)) {\r\n        // WHY?: people were using `component` property for `content`\r\n        // TODO: converge on one setting name\r\n        component = createViewHookComponent(Object.assign(Object.assign({}, rawOptions), { content: component }));\r\n    }\r\n    return {\r\n        superType: rawOptions.type,\r\n        component: component,\r\n        rawOptions, // includes type and component too :(\r\n    };\r\n}\r\nfunction createViewHookComponent(options) {\r\n    return (viewProps) => (createElement(ViewContextType.Consumer, null, (context) => (createElement(ContentContainer, { elTag: \"div\", elClasses: buildViewClassNames(context.viewSpec), renderProps: Object.assign(Object.assign({}, viewProps), { nextDayThreshold: context.options.nextDayThreshold }), generatorName: undefined, customGenerator: options.content, classNameGenerator: options.classNames, didMount: options.didMount, willUnmount: options.willUnmount }))));\r\n}\r\n\r\nfunction buildViewSpecs(defaultInputs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\r\n    let defaultConfigs = parseViewConfigs(defaultInputs);\r\n    let overrideConfigs = parseViewConfigs(optionOverrides.views);\r\n    let viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\r\n    return mapHash(viewDefs, (viewDef) => buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults));\r\n}\r\nfunction buildViewSpec(viewDef, overrideConfigs, optionOverrides, dynamicOptionOverrides, localeDefaults) {\r\n    let durationInput = viewDef.overrides.duration ||\r\n        viewDef.defaults.duration ||\r\n        dynamicOptionOverrides.duration ||\r\n        optionOverrides.duration;\r\n    let duration = null;\r\n    let durationUnit = '';\r\n    let singleUnit = '';\r\n    let singleUnitOverrides = {};\r\n    if (durationInput) {\r\n        duration = createDurationCached(durationInput);\r\n        if (duration) { // valid?\r\n            let denom = greatestDurationDenominator(duration);\r\n            durationUnit = denom.unit;\r\n            if (denom.value === 1) {\r\n                singleUnit = durationUnit;\r\n                singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].rawOptions : {};\r\n            }\r\n        }\r\n    }\r\n    let queryButtonText = (optionsSubset) => {\r\n        let buttonTextMap = optionsSubset.buttonText || {};\r\n        let buttonTextKey = viewDef.defaults.buttonTextKey;\r\n        if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\r\n            return buttonTextMap[buttonTextKey];\r\n        }\r\n        if (buttonTextMap[viewDef.type] != null) {\r\n            return buttonTextMap[viewDef.type];\r\n        }\r\n        if (buttonTextMap[singleUnit] != null) {\r\n            return buttonTextMap[singleUnit];\r\n        }\r\n        return null;\r\n    };\r\n    let queryButtonTitle = (optionsSubset) => {\r\n        let buttonHints = optionsSubset.buttonHints || {};\r\n        let buttonKey = viewDef.defaults.buttonTextKey; // use same key as text\r\n        if (buttonKey != null && buttonHints[buttonKey] != null) {\r\n            return buttonHints[buttonKey];\r\n        }\r\n        if (buttonHints[viewDef.type] != null) {\r\n            return buttonHints[viewDef.type];\r\n        }\r\n        if (buttonHints[singleUnit] != null) {\r\n            return buttonHints[singleUnit];\r\n        }\r\n        return null;\r\n    };\r\n    return {\r\n        type: viewDef.type,\r\n        component: viewDef.component,\r\n        duration,\r\n        durationUnit,\r\n        singleUnit,\r\n        optionDefaults: viewDef.defaults,\r\n        optionOverrides: Object.assign(Object.assign({}, singleUnitOverrides), viewDef.overrides),\r\n        buttonTextOverride: queryButtonText(dynamicOptionOverrides) ||\r\n            queryButtonText(optionOverrides) || // constructor-specified buttonText lookup hash takes precedence\r\n            viewDef.overrides.buttonText,\r\n        buttonTextDefault: queryButtonText(localeDefaults) ||\r\n            viewDef.defaults.buttonText ||\r\n            queryButtonText(BASE_OPTION_DEFAULTS) ||\r\n            viewDef.type,\r\n        // not DRY\r\n        buttonTitleOverride: queryButtonTitle(dynamicOptionOverrides) ||\r\n            queryButtonTitle(optionOverrides) ||\r\n            viewDef.overrides.buttonHint,\r\n        buttonTitleDefault: queryButtonTitle(localeDefaults) ||\r\n            viewDef.defaults.buttonHint ||\r\n            queryButtonTitle(BASE_OPTION_DEFAULTS),\r\n        // will eventually fall back to buttonText\r\n    };\r\n}\r\n// hack to get memoization working\r\nlet durationInputMap = {};\r\nfunction createDurationCached(durationInput) {\r\n    let json = JSON.stringify(durationInput);\r\n    let res = durationInputMap[json];\r\n    if (res === undefined) {\r\n        res = createDuration(durationInput);\r\n        durationInputMap[json] = res;\r\n    }\r\n    return res;\r\n}\r\n\r\nfunction reduceViewType(viewType, action) {\r\n    switch (action.type) {\r\n        case 'CHANGE_VIEW_TYPE':\r\n            viewType = action.viewType;\r\n    }\r\n    return viewType;\r\n}\r\n\r\nfunction reduceDynamicOptionOverrides(dynamicOptionOverrides, action) {\r\n    switch (action.type) {\r\n        case 'SET_OPTION':\r\n            return Object.assign(Object.assign({}, dynamicOptionOverrides), { [action.optionName]: action.rawOptionValue });\r\n        default:\r\n            return dynamicOptionOverrides;\r\n    }\r\n}\r\n\r\nfunction reduceDateProfile(currentDateProfile, action, currentDate, dateProfileGenerator) {\r\n    let dp;\r\n    switch (action.type) {\r\n        case 'CHANGE_VIEW_TYPE':\r\n            return dateProfileGenerator.build(action.dateMarker || currentDate);\r\n        case 'CHANGE_DATE':\r\n            return dateProfileGenerator.build(action.dateMarker);\r\n        case 'PREV':\r\n            dp = dateProfileGenerator.buildPrev(currentDateProfile, currentDate);\r\n            if (dp.isValid) {\r\n                return dp;\r\n            }\r\n            break;\r\n        case 'NEXT':\r\n            dp = dateProfileGenerator.buildNext(currentDateProfile, currentDate);\r\n            if (dp.isValid) {\r\n                return dp;\r\n            }\r\n            break;\r\n    }\r\n    return currentDateProfile;\r\n}\r\n\r\nfunction initEventSources(calendarOptions, dateProfile, context) {\r\n    let activeRange = dateProfile ? dateProfile.activeRange : null;\r\n    return addSources({}, parseInitialSources(calendarOptions, context), activeRange, context);\r\n}\r\nfunction reduceEventSources(eventSources, action, dateProfile, context) {\r\n    let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\r\n    switch (action.type) {\r\n        case 'ADD_EVENT_SOURCES': // already parsed\r\n            return addSources(eventSources, action.sources, activeRange, context);\r\n        case 'REMOVE_EVENT_SOURCE':\r\n            return removeSource(eventSources, action.sourceId);\r\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\r\n        case 'NEXT':\r\n        case 'CHANGE_DATE':\r\n        case 'CHANGE_VIEW_TYPE':\r\n            if (dateProfile) {\r\n                return fetchDirtySources(eventSources, activeRange, context);\r\n            }\r\n            return eventSources;\r\n        case 'FETCH_EVENT_SOURCES':\r\n            return fetchSourcesByIds(eventSources, action.sourceIds ? // why no type?\r\n                arrayToHash(action.sourceIds) :\r\n                excludeStaticSources(eventSources, context), activeRange, action.isRefetch || false, context);\r\n        case 'RECEIVE_EVENTS':\r\n        case 'RECEIVE_EVENT_ERROR':\r\n            return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\r\n        case 'REMOVE_ALL_EVENT_SOURCES':\r\n            return {};\r\n        default:\r\n            return eventSources;\r\n    }\r\n}\r\nfunction reduceEventSourcesNewTimeZone(eventSources, dateProfile, context) {\r\n    let activeRange = dateProfile ? dateProfile.activeRange : null; // need this check?\r\n    return fetchSourcesByIds(eventSources, excludeStaticSources(eventSources, context), activeRange, true, context);\r\n}\r\nfunction computeEventSourcesLoading(eventSources) {\r\n    for (let sourceId in eventSources) {\r\n        if (eventSources[sourceId].isFetching) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction addSources(eventSourceHash, sources, fetchRange, context) {\r\n    let hash = {};\r\n    for (let source of sources) {\r\n        hash[source.sourceId] = source;\r\n    }\r\n    if (fetchRange) {\r\n        hash = fetchDirtySources(hash, fetchRange, context);\r\n    }\r\n    return Object.assign(Object.assign({}, eventSourceHash), hash);\r\n}\r\nfunction removeSource(eventSourceHash, sourceId) {\r\n    return filterHash(eventSourceHash, (eventSource) => eventSource.sourceId !== sourceId);\r\n}\r\nfunction fetchDirtySources(sourceHash, fetchRange, context) {\r\n    return fetchSourcesByIds(sourceHash, filterHash(sourceHash, (eventSource) => isSourceDirty(eventSource, fetchRange, context)), fetchRange, false, context);\r\n}\r\nfunction isSourceDirty(eventSource, fetchRange, context) {\r\n    if (!doesSourceNeedRange(eventSource, context)) {\r\n        return !eventSource.latestFetchId;\r\n    }\r\n    return !context.options.lazyFetching ||\r\n        !eventSource.fetchRange ||\r\n        eventSource.isFetching || // always cancel outdated in-progress fetches\r\n        fetchRange.start < eventSource.fetchRange.start ||\r\n        fetchRange.end > eventSource.fetchRange.end;\r\n}\r\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, isRefetch, context) {\r\n    let nextSources = {};\r\n    for (let sourceId in prevSources) {\r\n        let source = prevSources[sourceId];\r\n        if (sourceIdHash[sourceId]) {\r\n            nextSources[sourceId] = fetchSource(source, fetchRange, isRefetch, context);\r\n        }\r\n        else {\r\n            nextSources[sourceId] = source;\r\n        }\r\n    }\r\n    return nextSources;\r\n}\r\nfunction fetchSource(eventSource, fetchRange, isRefetch, context) {\r\n    let { options, calendarApi } = context;\r\n    let sourceDef = context.pluginHooks.eventSourceDefs[eventSource.sourceDefId];\r\n    let fetchId = guid();\r\n    sourceDef.fetch({\r\n        eventSource,\r\n        range: fetchRange,\r\n        isRefetch,\r\n        context,\r\n    }, (res) => {\r\n        let { rawEvents } = res;\r\n        if (options.eventSourceSuccess) {\r\n            rawEvents = options.eventSourceSuccess.call(calendarApi, rawEvents, res.response) || rawEvents;\r\n        }\r\n        if (eventSource.success) {\r\n            rawEvents = eventSource.success.call(calendarApi, rawEvents, res.response) || rawEvents;\r\n        }\r\n        context.dispatch({\r\n            type: 'RECEIVE_EVENTS',\r\n            sourceId: eventSource.sourceId,\r\n            fetchId,\r\n            fetchRange,\r\n            rawEvents,\r\n        });\r\n    }, (error) => {\r\n        let errorHandled = false;\r\n        if (options.eventSourceFailure) {\r\n            options.eventSourceFailure.call(calendarApi, error);\r\n            errorHandled = true;\r\n        }\r\n        if (eventSource.failure) {\r\n            eventSource.failure(error);\r\n            errorHandled = true;\r\n        }\r\n        if (!errorHandled) {\r\n            console.warn(error.message, error);\r\n        }\r\n        context.dispatch({\r\n            type: 'RECEIVE_EVENT_ERROR',\r\n            sourceId: eventSource.sourceId,\r\n            fetchId,\r\n            fetchRange,\r\n            error,\r\n        });\r\n    });\r\n    return Object.assign(Object.assign({}, eventSource), { isFetching: true, latestFetchId: fetchId });\r\n}\r\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\r\n    let eventSource = sourceHash[sourceId];\r\n    if (eventSource && // not already removed\r\n        fetchId === eventSource.latestFetchId) {\r\n        return Object.assign(Object.assign({}, sourceHash), { [sourceId]: Object.assign(Object.assign({}, eventSource), { isFetching: false, fetchRange }) });\r\n    }\r\n    return sourceHash;\r\n}\r\nfunction excludeStaticSources(eventSources, context) {\r\n    return filterHash(eventSources, (eventSource) => doesSourceNeedRange(eventSource, context));\r\n}\r\nfunction parseInitialSources(rawOptions, context) {\r\n    let refiners = buildEventSourceRefiners(context);\r\n    let rawSources = [].concat(rawOptions.eventSources || []);\r\n    let sources = []; // parsed\r\n    if (rawOptions.initialEvents) {\r\n        rawSources.unshift(rawOptions.initialEvents);\r\n    }\r\n    if (rawOptions.events) {\r\n        rawSources.unshift(rawOptions.events);\r\n    }\r\n    for (let rawSource of rawSources) {\r\n        let source = parseEventSource(rawSource, context, refiners);\r\n        if (source) {\r\n            sources.push(source);\r\n        }\r\n    }\r\n    return sources;\r\n}\r\nfunction doesSourceNeedRange(eventSource, context) {\r\n    let defs = context.pluginHooks.eventSourceDefs;\r\n    return !defs[eventSource.sourceDefId].ignoreRange;\r\n}\r\n\r\nfunction reduceDateSelection(currentSelection, action) {\r\n    switch (action.type) {\r\n        case 'UNSELECT_DATES':\r\n            return null;\r\n        case 'SELECT_DATES':\r\n            return action.selection;\r\n        default:\r\n            return currentSelection;\r\n    }\r\n}\r\n\r\nfunction reduceSelectedEvent(currentInstanceId, action) {\r\n    switch (action.type) {\r\n        case 'UNSELECT_EVENT':\r\n            return '';\r\n        case 'SELECT_EVENT':\r\n            return action.eventInstanceId;\r\n        default:\r\n            return currentInstanceId;\r\n    }\r\n}\r\n\r\nfunction reduceEventDrag(currentDrag, action) {\r\n    let newDrag;\r\n    switch (action.type) {\r\n        case 'UNSET_EVENT_DRAG':\r\n            return null;\r\n        case 'SET_EVENT_DRAG':\r\n            newDrag = action.state;\r\n            return {\r\n                affectedEvents: newDrag.affectedEvents,\r\n                mutatedEvents: newDrag.mutatedEvents,\r\n                isEvent: newDrag.isEvent,\r\n            };\r\n        default:\r\n            return currentDrag;\r\n    }\r\n}\r\n\r\nfunction reduceEventResize(currentResize, action) {\r\n    let newResize;\r\n    switch (action.type) {\r\n        case 'UNSET_EVENT_RESIZE':\r\n            return null;\r\n        case 'SET_EVENT_RESIZE':\r\n            newResize = action.state;\r\n            return {\r\n                affectedEvents: newResize.affectedEvents,\r\n                mutatedEvents: newResize.mutatedEvents,\r\n                isEvent: newResize.isEvent,\r\n            };\r\n        default:\r\n            return currentResize;\r\n    }\r\n}\r\n\r\nfunction parseToolbars(calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\r\n    let header = calendarOptions.headerToolbar ? parseToolbar(calendarOptions.headerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\r\n    let footer = calendarOptions.footerToolbar ? parseToolbar(calendarOptions.footerToolbar, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) : null;\r\n    return { header, footer };\r\n}\r\nfunction parseToolbar(sectionStrHash, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi) {\r\n    let sectionWidgets = {};\r\n    let viewsWithButtons = [];\r\n    let hasTitle = false;\r\n    for (let sectionName in sectionStrHash) {\r\n        let sectionStr = sectionStrHash[sectionName];\r\n        let sectionRes = parseSection(sectionStr, calendarOptions, calendarOptionOverrides, theme, viewSpecs, calendarApi);\r\n        sectionWidgets[sectionName] = sectionRes.widgets;\r\n        viewsWithButtons.push(...sectionRes.viewsWithButtons);\r\n        hasTitle = hasTitle || sectionRes.hasTitle;\r\n    }\r\n    return { sectionWidgets, viewsWithButtons, hasTitle };\r\n}\r\n/*\r\nBAD: querying icons and text here. should be done at render time\r\n*/\r\nfunction parseSection(sectionStr, calendarOptions, // defaults+overrides, then refined\r\ncalendarOptionOverrides, // overrides only!, unrefined :(\r\ntheme, viewSpecs, calendarApi) {\r\n    let isRtl = calendarOptions.direction === 'rtl';\r\n    let calendarCustomButtons = calendarOptions.customButtons || {};\r\n    let calendarButtonTextOverrides = calendarOptionOverrides.buttonText || {};\r\n    let calendarButtonText = calendarOptions.buttonText || {};\r\n    let calendarButtonHintOverrides = calendarOptionOverrides.buttonHints || {};\r\n    let calendarButtonHints = calendarOptions.buttonHints || {};\r\n    let sectionSubstrs = sectionStr ? sectionStr.split(' ') : [];\r\n    let viewsWithButtons = [];\r\n    let hasTitle = false;\r\n    let widgets = sectionSubstrs.map((buttonGroupStr) => (buttonGroupStr.split(',').map((buttonName) => {\r\n        if (buttonName === 'title') {\r\n            hasTitle = true;\r\n            return { buttonName };\r\n        }\r\n        let customButtonProps;\r\n        let viewSpec;\r\n        let buttonClick;\r\n        let buttonIcon; // only one of these will be set\r\n        let buttonText; // \"\r\n        let buttonHint;\r\n        // ^ for the title=\"\" attribute, for accessibility\r\n        if ((customButtonProps = calendarCustomButtons[buttonName])) {\r\n            buttonClick = (ev) => {\r\n                if (customButtonProps.click) {\r\n                    customButtonProps.click.call(ev.target, ev, ev.target); // TODO: use Calendar this context?\r\n                }\r\n            };\r\n            (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\r\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\r\n                (buttonText = customButtonProps.text);\r\n            buttonHint = customButtonProps.hint || customButtonProps.text;\r\n        }\r\n        else if ((viewSpec = viewSpecs[buttonName])) {\r\n            viewsWithButtons.push(buttonName);\r\n            buttonClick = () => {\r\n                calendarApi.changeView(buttonName);\r\n            };\r\n            (buttonText = viewSpec.buttonTextOverride) ||\r\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\r\n                (buttonText = viewSpec.buttonTextDefault);\r\n            let textFallback = viewSpec.buttonTextOverride ||\r\n                viewSpec.buttonTextDefault;\r\n            buttonHint = formatWithOrdinals(viewSpec.buttonTitleOverride ||\r\n                viewSpec.buttonTitleDefault ||\r\n                calendarOptions.viewHint, [textFallback, buttonName], // view-name = buttonName\r\n            textFallback);\r\n        }\r\n        else if (calendarApi[buttonName]) { // a calendarApi method\r\n            buttonClick = () => {\r\n                calendarApi[buttonName]();\r\n            };\r\n            (buttonText = calendarButtonTextOverrides[buttonName]) ||\r\n                (buttonIcon = theme.getIconClass(buttonName, isRtl)) ||\r\n                (buttonText = calendarButtonText[buttonName]); // everything else is considered default\r\n            if (buttonName === 'prevYear' || buttonName === 'nextYear') {\r\n                let prevOrNext = buttonName === 'prevYear' ? 'prev' : 'next';\r\n                buttonHint = formatWithOrdinals(calendarButtonHintOverrides[prevOrNext] ||\r\n                    calendarButtonHints[prevOrNext], [\r\n                    calendarButtonText.year || 'year',\r\n                    'year',\r\n                ], calendarButtonText[buttonName]);\r\n            }\r\n            else {\r\n                buttonHint = (navUnit) => formatWithOrdinals(calendarButtonHintOverrides[buttonName] ||\r\n                    calendarButtonHints[buttonName], [\r\n                    calendarButtonText[navUnit] || navUnit,\r\n                    navUnit,\r\n                ], calendarButtonText[buttonName]);\r\n            }\r\n        }\r\n        return { buttonName, buttonClick, buttonIcon, buttonText, buttonHint };\r\n    })));\r\n    return { widgets, viewsWithButtons, hasTitle };\r\n}\r\n\r\n// always represents the current view. otherwise, it'd need to change value every time date changes\r\nclass ViewImpl {\r\n    constructor(type, getCurrentData, dateEnv) {\r\n        this.type = type;\r\n        this.getCurrentData = getCurrentData;\r\n        this.dateEnv = dateEnv;\r\n    }\r\n    get calendar() {\r\n        return this.getCurrentData().calendarApi;\r\n    }\r\n    get title() {\r\n        return this.getCurrentData().viewTitle;\r\n    }\r\n    get activeStart() {\r\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start);\r\n    }\r\n    get activeEnd() {\r\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end);\r\n    }\r\n    get currentStart() {\r\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start);\r\n    }\r\n    get currentEnd() {\r\n        return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end);\r\n    }\r\n    getOption(name) {\r\n        return this.getCurrentData().options[name]; // are the view-specific options\r\n    }\r\n}\r\n\r\nlet eventSourceDef$2 = {\r\n    ignoreRange: true,\r\n    parseMeta(refined) {\r\n        if (Array.isArray(refined.events)) {\r\n            return refined.events;\r\n        }\r\n        return null;\r\n    },\r\n    fetch(arg, successCallback) {\r\n        successCallback({\r\n            rawEvents: arg.eventSource.meta,\r\n        });\r\n    },\r\n};\r\nconst arrayEventSourcePlugin = createPlugin({\r\n    name: 'array-event-source',\r\n    eventSourceDefs: [eventSourceDef$2],\r\n});\r\n\r\nlet eventSourceDef$1 = {\r\n    parseMeta(refined) {\r\n        if (typeof refined.events === 'function') {\r\n            return refined.events;\r\n        }\r\n        return null;\r\n    },\r\n    fetch(arg, successCallback, errorCallback) {\r\n        const { dateEnv } = arg.context;\r\n        const func = arg.eventSource.meta;\r\n        unpromisify(func.bind(null, buildRangeApiWithTimeZone(arg.range, dateEnv)), (rawEvents) => successCallback({ rawEvents }), errorCallback);\r\n    },\r\n};\r\nconst funcEventSourcePlugin = createPlugin({\r\n    name: 'func-event-source',\r\n    eventSourceDefs: [eventSourceDef$1],\r\n});\r\n\r\nconst JSON_FEED_EVENT_SOURCE_REFINERS = {\r\n    method: String,\r\n    extraParams: identity,\r\n    startParam: String,\r\n    endParam: String,\r\n    timeZoneParam: String,\r\n};\r\n\r\nlet eventSourceDef = {\r\n    parseMeta(refined) {\r\n        if (refined.url && (refined.format === 'json' || !refined.format)) {\r\n            return {\r\n                url: refined.url,\r\n                format: 'json',\r\n                method: (refined.method || 'GET').toUpperCase(),\r\n                extraParams: refined.extraParams,\r\n                startParam: refined.startParam,\r\n                endParam: refined.endParam,\r\n                timeZoneParam: refined.timeZoneParam,\r\n            };\r\n        }\r\n        return null;\r\n    },\r\n    fetch(arg, successCallback, errorCallback) {\r\n        const { meta } = arg.eventSource;\r\n        const requestParams = buildRequestParams(meta, arg.range, arg.context);\r\n        requestJson(meta.method, meta.url, requestParams).then(([rawEvents, response]) => {\r\n            successCallback({ rawEvents, response });\r\n        }, errorCallback);\r\n    },\r\n};\r\nconst jsonFeedEventSourcePlugin = createPlugin({\r\n    name: 'json-event-source',\r\n    eventSourceRefiners: JSON_FEED_EVENT_SOURCE_REFINERS,\r\n    eventSourceDefs: [eventSourceDef],\r\n});\r\nfunction buildRequestParams(meta, range, context) {\r\n    let { dateEnv, options } = context;\r\n    let startParam;\r\n    let endParam;\r\n    let timeZoneParam;\r\n    let customRequestParams;\r\n    let params = {};\r\n    startParam = meta.startParam;\r\n    if (startParam == null) {\r\n        startParam = options.startParam;\r\n    }\r\n    endParam = meta.endParam;\r\n    if (endParam == null) {\r\n        endParam = options.endParam;\r\n    }\r\n    timeZoneParam = meta.timeZoneParam;\r\n    if (timeZoneParam == null) {\r\n        timeZoneParam = options.timeZoneParam;\r\n    }\r\n    // retrieve any outbound GET/POST data from the options\r\n    if (typeof meta.extraParams === 'function') {\r\n        // supplied as a function that returns a key/value object\r\n        customRequestParams = meta.extraParams();\r\n    }\r\n    else {\r\n        // probably supplied as a straight key/value object\r\n        customRequestParams = meta.extraParams || {};\r\n    }\r\n    Object.assign(params, customRequestParams);\r\n    params[startParam] = dateEnv.formatIso(range.start);\r\n    params[endParam] = dateEnv.formatIso(range.end);\r\n    if (dateEnv.timeZone !== 'local') {\r\n        params[timeZoneParam] = dateEnv.timeZone;\r\n    }\r\n    return params;\r\n}\r\n\r\nconst SIMPLE_RECURRING_REFINERS = {\r\n    daysOfWeek: identity,\r\n    startTime: createDuration,\r\n    endTime: createDuration,\r\n    duration: createDuration,\r\n    startRecur: identity,\r\n    endRecur: identity,\r\n};\r\n\r\nlet recurring = {\r\n    parse(refined, dateEnv) {\r\n        if (refined.daysOfWeek || refined.startTime || refined.endTime || refined.startRecur || refined.endRecur) {\r\n            let recurringData = {\r\n                daysOfWeek: refined.daysOfWeek || null,\r\n                startTime: refined.startTime || null,\r\n                endTime: refined.endTime || null,\r\n                startRecur: refined.startRecur ? dateEnv.createMarker(refined.startRecur) : null,\r\n                endRecur: refined.endRecur ? dateEnv.createMarker(refined.endRecur) : null,\r\n            };\r\n            let duration;\r\n            if (refined.duration) {\r\n                duration = refined.duration;\r\n            }\r\n            if (!duration && refined.startTime && refined.endTime) {\r\n                duration = subtractDurations(refined.endTime, refined.startTime);\r\n            }\r\n            return {\r\n                allDayGuess: Boolean(!refined.startTime && !refined.endTime),\r\n                duration,\r\n                typeData: recurringData, // doesn't need endTime anymore but oh well\r\n            };\r\n        }\r\n        return null;\r\n    },\r\n    expand(typeData, framingRange, dateEnv) {\r\n        let clippedFramingRange = intersectRanges(framingRange, { start: typeData.startRecur, end: typeData.endRecur });\r\n        if (clippedFramingRange) {\r\n            return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\r\n        }\r\n        return [];\r\n    },\r\n};\r\nconst simpleRecurringEventsPlugin = createPlugin({\r\n    name: 'simple-recurring-event',\r\n    recurringTypes: [recurring],\r\n    eventRefiners: SIMPLE_RECURRING_REFINERS,\r\n});\r\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\r\n    let dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\r\n    let dayMarker = startOfDay(framingRange.start);\r\n    let endMarker = framingRange.end;\r\n    let instanceStarts = [];\r\n    while (dayMarker < endMarker) {\r\n        let instanceStart;\r\n        // if everyday, or this particular day-of-week\r\n        if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\r\n            if (startTime) {\r\n                instanceStart = dateEnv.add(dayMarker, startTime);\r\n            }\r\n            else {\r\n                instanceStart = dayMarker;\r\n            }\r\n            instanceStarts.push(instanceStart);\r\n        }\r\n        dayMarker = addDays(dayMarker, 1);\r\n    }\r\n    return instanceStarts;\r\n}\r\n\r\nconst changeHandlerPlugin = createPlugin({\r\n    name: 'change-handler',\r\n    optionChangeHandlers: {\r\n        events(events, context) {\r\n            handleEventSources([events], context);\r\n        },\r\n        eventSources: handleEventSources,\r\n    },\r\n});\r\n/*\r\nBUG: if `event` was supplied, all previously-given `eventSources` will be wiped out\r\n*/\r\nfunction handleEventSources(inputs, context) {\r\n    let unfoundSources = hashValuesToArray(context.getCurrentData().eventSources);\r\n    if (unfoundSources.length === 1 &&\r\n        inputs.length === 1 &&\r\n        Array.isArray(unfoundSources[0]._raw) &&\r\n        Array.isArray(inputs[0])) {\r\n        context.dispatch({\r\n            type: 'RESET_RAW_EVENTS',\r\n            sourceId: unfoundSources[0].sourceId,\r\n            rawEvents: inputs[0],\r\n        });\r\n        return;\r\n    }\r\n    let newInputs = [];\r\n    for (let input of inputs) {\r\n        let inputFound = false;\r\n        for (let i = 0; i < unfoundSources.length; i += 1) {\r\n            if (unfoundSources[i]._raw === input) {\r\n                unfoundSources.splice(i, 1); // delete\r\n                inputFound = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!inputFound) {\r\n            newInputs.push(input);\r\n        }\r\n    }\r\n    for (let unfoundSource of unfoundSources) {\r\n        context.dispatch({\r\n            type: 'REMOVE_EVENT_SOURCE',\r\n            sourceId: unfoundSource.sourceId,\r\n        });\r\n    }\r\n    for (let newInput of newInputs) {\r\n        context.calendarApi.addEventSource(newInput);\r\n    }\r\n}\r\n\r\nfunction handleDateProfile(dateProfile, context) {\r\n    context.emitter.trigger('datesSet', Object.assign(Object.assign({}, buildRangeApiWithTimeZone(dateProfile.activeRange, context.dateEnv)), { view: context.viewApi }));\r\n}\r\n\r\nfunction handleEventStore(eventStore, context) {\r\n    let { emitter } = context;\r\n    if (emitter.hasHandlers('eventsSet')) {\r\n        emitter.trigger('eventsSet', buildEventApis(eventStore, context));\r\n    }\r\n}\r\n\r\n/*\r\nthis array is exposed on the root namespace so that UMD plugins can add to it.\r\nsee the rollup-bundles script.\r\n*/\r\nconst globalPlugins = [\r\n    arrayEventSourcePlugin,\r\n    funcEventSourcePlugin,\r\n    jsonFeedEventSourcePlugin,\r\n    simpleRecurringEventsPlugin,\r\n    changeHandlerPlugin,\r\n    createPlugin({\r\n        name: 'misc',\r\n        isLoadingFuncs: [\r\n            (state) => computeEventSourcesLoading(state.eventSources),\r\n        ],\r\n        propSetHandlers: {\r\n            dateProfile: handleDateProfile,\r\n            eventStore: handleEventStore,\r\n        },\r\n    }),\r\n];\r\n\r\nclass TaskRunner {\r\n    constructor(runTaskOption, drainedOption) {\r\n        this.runTaskOption = runTaskOption;\r\n        this.drainedOption = drainedOption;\r\n        this.queue = [];\r\n        this.delayedRunner = new DelayedRunner(this.drain.bind(this));\r\n    }\r\n    request(task, delay) {\r\n        this.queue.push(task);\r\n        this.delayedRunner.request(delay);\r\n    }\r\n    pause(scope) {\r\n        this.delayedRunner.pause(scope);\r\n    }\r\n    resume(scope, force) {\r\n        this.delayedRunner.resume(scope, force);\r\n    }\r\n    drain() {\r\n        let { queue } = this;\r\n        while (queue.length) {\r\n            let completedTasks = [];\r\n            let task;\r\n            while ((task = queue.shift())) {\r\n                this.runTask(task);\r\n                completedTasks.push(task);\r\n            }\r\n            this.drained(completedTasks);\r\n        } // keep going, in case new tasks were added in the drained handler\r\n    }\r\n    runTask(task) {\r\n        if (this.runTaskOption) {\r\n            this.runTaskOption(task);\r\n        }\r\n    }\r\n    drained(completedTasks) {\r\n        if (this.drainedOption) {\r\n            this.drainedOption(completedTasks);\r\n        }\r\n    }\r\n}\r\n\r\n// Computes what the title at the top of the calendarApi should be for this view\r\nfunction buildTitle(dateProfile, viewOptions, dateEnv) {\r\n    let range;\r\n    // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\r\n    if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\r\n        range = dateProfile.currentRange;\r\n    }\r\n    else { // for day units or smaller, use the actual day range\r\n        range = dateProfile.activeRange;\r\n    }\r\n    return dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || buildTitleFormat(dateProfile)), {\r\n        isEndExclusive: dateProfile.isRangeAllDay,\r\n        defaultSeparator: viewOptions.titleRangeSeparator,\r\n    });\r\n}\r\n// Generates the format string that should be used to generate the title for the current date range.\r\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\r\nfunction buildTitleFormat(dateProfile) {\r\n    let { currentRangeUnit } = dateProfile;\r\n    if (currentRangeUnit === 'year') {\r\n        return { year: 'numeric' };\r\n    }\r\n    if (currentRangeUnit === 'month') {\r\n        return { year: 'numeric', month: 'long' }; // like \"September 2014\"\r\n    }\r\n    let days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\r\n    if (days !== null && days > 1) {\r\n        // multi-day range. shorter, like \"Sep 9 - 10 2014\"\r\n        return { year: 'numeric', month: 'short', day: 'numeric' };\r\n    }\r\n    // one day. longer, like \"September 9 2014\"\r\n    return { year: 'numeric', month: 'long', day: 'numeric' };\r\n}\r\n\r\n// in future refactor, do the redux-style function(state=initial) for initial-state\r\n// also, whatever is happening in constructor, have it happen in action queue too\r\nclass CalendarDataManager {\r\n    constructor(props) {\r\n        this.computeCurrentViewData = memoize(this._computeCurrentViewData);\r\n        this.organizeRawLocales = memoize(organizeRawLocales);\r\n        this.buildLocale = memoize(buildLocale);\r\n        this.buildPluginHooks = buildBuildPluginHooks();\r\n        this.buildDateEnv = memoize(buildDateEnv$1);\r\n        this.buildTheme = memoize(buildTheme);\r\n        this.parseToolbars = memoize(parseToolbars);\r\n        this.buildViewSpecs = memoize(buildViewSpecs);\r\n        this.buildDateProfileGenerator = memoizeObjArg(buildDateProfileGenerator);\r\n        this.buildViewApi = memoize(buildViewApi);\r\n        this.buildViewUiProps = memoizeObjArg(buildViewUiProps);\r\n        this.buildEventUiBySource = memoize(buildEventUiBySource, isPropsEqual);\r\n        this.buildEventUiBases = memoize(buildEventUiBases);\r\n        this.parseContextBusinessHours = memoizeObjArg(parseContextBusinessHours);\r\n        this.buildTitle = memoize(buildTitle);\r\n        this.emitter = new Emitter();\r\n        this.actionRunner = new TaskRunner(this._handleAction.bind(this), this.updateData.bind(this));\r\n        this.currentCalendarOptionsInput = {};\r\n        this.currentCalendarOptionsRefined = {};\r\n        this.currentViewOptionsInput = {};\r\n        this.currentViewOptionsRefined = {};\r\n        this.currentCalendarOptionsRefiners = {};\r\n        this.optionsForRefining = [];\r\n        this.optionsForHandling = [];\r\n        this.getCurrentData = () => this.data;\r\n        this.dispatch = (action) => {\r\n            this.actionRunner.request(action); // protects against recursive calls to _handleAction\r\n        };\r\n        this.props = props;\r\n        this.actionRunner.pause();\r\n        let dynamicOptionOverrides = {};\r\n        let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\r\n        let currentViewType = optionsData.calendarOptions.initialView || optionsData.pluginHooks.initialView;\r\n        let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\r\n        // wire things up\r\n        // TODO: not DRY\r\n        props.calendarApi.currentDataManager = this;\r\n        this.emitter.setThisContext(props.calendarApi);\r\n        this.emitter.setOptions(currentViewData.options);\r\n        let currentDate = getInitialDate(optionsData.calendarOptions, optionsData.dateEnv);\r\n        let dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\r\n        if (!rangeContainsMarker(dateProfile.activeRange, currentDate)) {\r\n            currentDate = dateProfile.currentRange.start;\r\n        }\r\n        let calendarContext = {\r\n            dateEnv: optionsData.dateEnv,\r\n            options: optionsData.calendarOptions,\r\n            pluginHooks: optionsData.pluginHooks,\r\n            calendarApi: props.calendarApi,\r\n            dispatch: this.dispatch,\r\n            emitter: this.emitter,\r\n            getCurrentData: this.getCurrentData,\r\n        };\r\n        // needs to be after setThisContext\r\n        for (let callback of optionsData.pluginHooks.contextInit) {\r\n            callback(calendarContext);\r\n        }\r\n        // NOT DRY\r\n        let eventSources = initEventSources(optionsData.calendarOptions, dateProfile, calendarContext);\r\n        let initialState = {\r\n            dynamicOptionOverrides,\r\n            currentViewType,\r\n            currentDate,\r\n            dateProfile,\r\n            businessHours: this.parseContextBusinessHours(calendarContext),\r\n            eventSources,\r\n            eventUiBases: {},\r\n            eventStore: createEmptyEventStore(),\r\n            renderableEventStore: createEmptyEventStore(),\r\n            dateSelection: null,\r\n            eventSelection: '',\r\n            eventDrag: null,\r\n            eventResize: null,\r\n            selectionConfig: this.buildViewUiProps(calendarContext).selectionConfig,\r\n        };\r\n        let contextAndState = Object.assign(Object.assign({}, calendarContext), initialState);\r\n        for (let reducer of optionsData.pluginHooks.reducers) {\r\n            Object.assign(initialState, reducer(null, null, contextAndState));\r\n        }\r\n        if (computeIsLoading(initialState, calendarContext)) {\r\n            this.emitter.trigger('loading', true); // NOT DRY\r\n        }\r\n        this.state = initialState;\r\n        this.updateData();\r\n        this.actionRunner.resume();\r\n    }\r\n    resetOptions(optionOverrides, changedOptionNames) {\r\n        let { props } = this;\r\n        if (changedOptionNames === undefined) {\r\n            props.optionOverrides = optionOverrides;\r\n        }\r\n        else {\r\n            props.optionOverrides = Object.assign(Object.assign({}, (props.optionOverrides || {})), optionOverrides);\r\n            this.optionsForRefining.push(...changedOptionNames);\r\n        }\r\n        if (changedOptionNames === undefined || changedOptionNames.length) {\r\n            this.actionRunner.request({\r\n                type: 'NOTHING',\r\n            });\r\n        }\r\n    }\r\n    _handleAction(action) {\r\n        let { props, state, emitter } = this;\r\n        let dynamicOptionOverrides = reduceDynamicOptionOverrides(state.dynamicOptionOverrides, action);\r\n        let optionsData = this.computeOptionsData(props.optionOverrides, dynamicOptionOverrides, props.calendarApi);\r\n        let currentViewType = reduceViewType(state.currentViewType, action);\r\n        let currentViewData = this.computeCurrentViewData(currentViewType, optionsData, props.optionOverrides, dynamicOptionOverrides);\r\n        // wire things up\r\n        // TODO: not DRY\r\n        props.calendarApi.currentDataManager = this;\r\n        emitter.setThisContext(props.calendarApi);\r\n        emitter.setOptions(currentViewData.options);\r\n        let calendarContext = {\r\n            dateEnv: optionsData.dateEnv,\r\n            options: optionsData.calendarOptions,\r\n            pluginHooks: optionsData.pluginHooks,\r\n            calendarApi: props.calendarApi,\r\n            dispatch: this.dispatch,\r\n            emitter,\r\n            getCurrentData: this.getCurrentData,\r\n        };\r\n        let { currentDate, dateProfile } = state;\r\n        if (this.data && this.data.dateProfileGenerator !== currentViewData.dateProfileGenerator) { // hack\r\n            dateProfile = currentViewData.dateProfileGenerator.build(currentDate);\r\n        }\r\n        currentDate = reduceCurrentDate(currentDate, action);\r\n        dateProfile = reduceDateProfile(dateProfile, action, currentDate, currentViewData.dateProfileGenerator);\r\n        if (action.type === 'PREV' || // TODO: move this logic into DateProfileGenerator\r\n            action.type === 'NEXT' || // \"\r\n            !rangeContainsMarker(dateProfile.currentRange, currentDate)) {\r\n            currentDate = dateProfile.currentRange.start;\r\n        }\r\n        let eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendarContext);\r\n        let eventStore = reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendarContext);\r\n        let isEventsLoading = computeEventSourcesLoading(eventSources); // BAD. also called in this func in computeIsLoading\r\n        let renderableEventStore = (isEventsLoading && !currentViewData.options.progressiveEventRendering) ?\r\n            (state.renderableEventStore || eventStore) : // try from previous state\r\n            eventStore;\r\n        let { eventUiSingleBase, selectionConfig } = this.buildViewUiProps(calendarContext); // will memoize obj\r\n        let eventUiBySource = this.buildEventUiBySource(eventSources);\r\n        let eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\r\n        let newState = {\r\n            dynamicOptionOverrides,\r\n            currentViewType,\r\n            currentDate,\r\n            dateProfile,\r\n            eventSources,\r\n            eventStore,\r\n            renderableEventStore,\r\n            selectionConfig,\r\n            eventUiBases,\r\n            businessHours: this.parseContextBusinessHours(calendarContext),\r\n            dateSelection: reduceDateSelection(state.dateSelection, action),\r\n            eventSelection: reduceSelectedEvent(state.eventSelection, action),\r\n            eventDrag: reduceEventDrag(state.eventDrag, action),\r\n            eventResize: reduceEventResize(state.eventResize, action),\r\n        };\r\n        let contextAndState = Object.assign(Object.assign({}, calendarContext), newState);\r\n        for (let reducer of optionsData.pluginHooks.reducers) {\r\n            Object.assign(newState, reducer(state, action, contextAndState)); // give the OLD state, for old value\r\n        }\r\n        let wasLoading = computeIsLoading(state, calendarContext);\r\n        let isLoading = computeIsLoading(newState, calendarContext);\r\n        // TODO: use propSetHandlers in plugin system\r\n        if (!wasLoading && isLoading) {\r\n            emitter.trigger('loading', true);\r\n        }\r\n        else if (wasLoading && !isLoading) {\r\n            emitter.trigger('loading', false);\r\n        }\r\n        this.state = newState;\r\n        if (props.onAction) {\r\n            props.onAction(action);\r\n        }\r\n    }\r\n    updateData() {\r\n        let { props, state } = this;\r\n        let oldData = this.data;\r\n        let optionsData = this.computeOptionsData(props.optionOverrides, state.dynamicOptionOverrides, props.calendarApi);\r\n        let currentViewData = this.computeCurrentViewData(state.currentViewType, optionsData, props.optionOverrides, state.dynamicOptionOverrides);\r\n        let data = this.data = Object.assign(Object.assign(Object.assign({ viewTitle: this.buildTitle(state.dateProfile, currentViewData.options, optionsData.dateEnv), calendarApi: props.calendarApi, dispatch: this.dispatch, emitter: this.emitter, getCurrentData: this.getCurrentData }, optionsData), currentViewData), state);\r\n        let changeHandlers = optionsData.pluginHooks.optionChangeHandlers;\r\n        let oldCalendarOptions = oldData && oldData.calendarOptions;\r\n        let newCalendarOptions = optionsData.calendarOptions;\r\n        if (oldCalendarOptions && oldCalendarOptions !== newCalendarOptions) {\r\n            if (oldCalendarOptions.timeZone !== newCalendarOptions.timeZone) {\r\n                // hack\r\n                state.eventSources = data.eventSources = reduceEventSourcesNewTimeZone(data.eventSources, state.dateProfile, data);\r\n                state.eventStore = data.eventStore = rezoneEventStoreDates(data.eventStore, oldData.dateEnv, data.dateEnv);\r\n                state.renderableEventStore = data.renderableEventStore = rezoneEventStoreDates(data.renderableEventStore, oldData.dateEnv, data.dateEnv);\r\n            }\r\n            for (let optionName in changeHandlers) {\r\n                if (this.optionsForHandling.indexOf(optionName) !== -1 ||\r\n                    oldCalendarOptions[optionName] !== newCalendarOptions[optionName]) {\r\n                    changeHandlers[optionName](newCalendarOptions[optionName], data);\r\n                }\r\n            }\r\n        }\r\n        this.optionsForHandling = [];\r\n        if (props.onData) {\r\n            props.onData(data);\r\n        }\r\n    }\r\n    computeOptionsData(optionOverrides, dynamicOptionOverrides, calendarApi) {\r\n        // TODO: blacklist options that are handled by optionChangeHandlers\r\n        if (!this.optionsForRefining.length &&\r\n            optionOverrides === this.stableOptionOverrides &&\r\n            dynamicOptionOverrides === this.stableDynamicOptionOverrides) {\r\n            return this.stableCalendarOptionsData;\r\n        }\r\n        let { refinedOptions, pluginHooks, localeDefaults, availableLocaleData, extra, } = this.processRawCalendarOptions(optionOverrides, dynamicOptionOverrides);\r\n        warnUnknownOptions(extra);\r\n        let dateEnv = this.buildDateEnv(refinedOptions.timeZone, refinedOptions.locale, refinedOptions.weekNumberCalculation, refinedOptions.firstDay, refinedOptions.weekText, pluginHooks, availableLocaleData, refinedOptions.defaultRangeSeparator);\r\n        let viewSpecs = this.buildViewSpecs(pluginHooks.views, this.stableOptionOverrides, this.stableDynamicOptionOverrides, localeDefaults);\r\n        let theme = this.buildTheme(refinedOptions, pluginHooks);\r\n        let toolbarConfig = this.parseToolbars(refinedOptions, this.stableOptionOverrides, theme, viewSpecs, calendarApi);\r\n        return this.stableCalendarOptionsData = {\r\n            calendarOptions: refinedOptions,\r\n            pluginHooks,\r\n            dateEnv,\r\n            viewSpecs,\r\n            theme,\r\n            toolbarConfig,\r\n            localeDefaults,\r\n            availableRawLocales: availableLocaleData.map,\r\n        };\r\n    }\r\n    // always called from behind a memoizer\r\n    processRawCalendarOptions(optionOverrides, dynamicOptionOverrides) {\r\n        let { locales, locale } = mergeRawOptions([\r\n            BASE_OPTION_DEFAULTS,\r\n            optionOverrides,\r\n            dynamicOptionOverrides,\r\n        ]);\r\n        let availableLocaleData = this.organizeRawLocales(locales);\r\n        let availableRawLocales = availableLocaleData.map;\r\n        let localeDefaults = this.buildLocale(locale || availableLocaleData.defaultCode, availableRawLocales).options;\r\n        let pluginHooks = this.buildPluginHooks(optionOverrides.plugins || [], globalPlugins);\r\n        let refiners = this.currentCalendarOptionsRefiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\r\n        let extra = {};\r\n        let raw = mergeRawOptions([\r\n            BASE_OPTION_DEFAULTS,\r\n            localeDefaults,\r\n            optionOverrides,\r\n            dynamicOptionOverrides,\r\n        ]);\r\n        let refined = {};\r\n        let currentRaw = this.currentCalendarOptionsInput;\r\n        let currentRefined = this.currentCalendarOptionsRefined;\r\n        let anyChanges = false;\r\n        for (let optionName in raw) {\r\n            if (this.optionsForRefining.indexOf(optionName) === -1 && (raw[optionName] === currentRaw[optionName] || (COMPLEX_OPTION_COMPARATORS[optionName] &&\r\n                (optionName in currentRaw) &&\r\n                COMPLEX_OPTION_COMPARATORS[optionName](currentRaw[optionName], raw[optionName])))) {\r\n                refined[optionName] = currentRefined[optionName];\r\n            }\r\n            else if (refiners[optionName]) {\r\n                refined[optionName] = refiners[optionName](raw[optionName]);\r\n                anyChanges = true;\r\n            }\r\n            else {\r\n                extra[optionName] = currentRaw[optionName];\r\n            }\r\n        }\r\n        if (anyChanges) {\r\n            this.currentCalendarOptionsInput = raw;\r\n            this.currentCalendarOptionsRefined = refined;\r\n            this.stableOptionOverrides = optionOverrides;\r\n            this.stableDynamicOptionOverrides = dynamicOptionOverrides;\r\n        }\r\n        this.optionsForHandling.push(...this.optionsForRefining);\r\n        this.optionsForRefining = [];\r\n        return {\r\n            rawOptions: this.currentCalendarOptionsInput,\r\n            refinedOptions: this.currentCalendarOptionsRefined,\r\n            pluginHooks,\r\n            availableLocaleData,\r\n            localeDefaults,\r\n            extra,\r\n        };\r\n    }\r\n    _computeCurrentViewData(viewType, optionsData, optionOverrides, dynamicOptionOverrides) {\r\n        let viewSpec = optionsData.viewSpecs[viewType];\r\n        if (!viewSpec) {\r\n            throw new Error(`viewType \"${viewType}\" is not available. Please make sure you've loaded all neccessary plugins`);\r\n        }\r\n        let { refinedOptions, extra } = this.processRawViewOptions(viewSpec, optionsData.pluginHooks, optionsData.localeDefaults, optionOverrides, dynamicOptionOverrides);\r\n        warnUnknownOptions(extra);\r\n        let dateProfileGenerator = this.buildDateProfileGenerator({\r\n            dateProfileGeneratorClass: viewSpec.optionDefaults.dateProfileGeneratorClass,\r\n            duration: viewSpec.duration,\r\n            durationUnit: viewSpec.durationUnit,\r\n            usesMinMaxTime: viewSpec.optionDefaults.usesMinMaxTime,\r\n            dateEnv: optionsData.dateEnv,\r\n            calendarApi: this.props.calendarApi,\r\n            slotMinTime: refinedOptions.slotMinTime,\r\n            slotMaxTime: refinedOptions.slotMaxTime,\r\n            showNonCurrentDates: refinedOptions.showNonCurrentDates,\r\n            dayCount: refinedOptions.dayCount,\r\n            dateAlignment: refinedOptions.dateAlignment,\r\n            dateIncrement: refinedOptions.dateIncrement,\r\n            hiddenDays: refinedOptions.hiddenDays,\r\n            weekends: refinedOptions.weekends,\r\n            nowInput: refinedOptions.now,\r\n            validRangeInput: refinedOptions.validRange,\r\n            visibleRangeInput: refinedOptions.visibleRange,\r\n            fixedWeekCount: refinedOptions.fixedWeekCount,\r\n        });\r\n        let viewApi = this.buildViewApi(viewType, this.getCurrentData, optionsData.dateEnv);\r\n        return { viewSpec, options: refinedOptions, dateProfileGenerator, viewApi };\r\n    }\r\n    processRawViewOptions(viewSpec, pluginHooks, localeDefaults, optionOverrides, dynamicOptionOverrides) {\r\n        let raw = mergeRawOptions([\r\n            BASE_OPTION_DEFAULTS,\r\n            viewSpec.optionDefaults,\r\n            localeDefaults,\r\n            optionOverrides,\r\n            viewSpec.optionOverrides,\r\n            dynamicOptionOverrides,\r\n        ]);\r\n        let refiners = Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, BASE_OPTION_REFINERS), CALENDAR_LISTENER_REFINERS), CALENDAR_OPTION_REFINERS), VIEW_OPTION_REFINERS), pluginHooks.listenerRefiners), pluginHooks.optionRefiners);\r\n        let refined = {};\r\n        let currentRaw = this.currentViewOptionsInput;\r\n        let currentRefined = this.currentViewOptionsRefined;\r\n        let anyChanges = false;\r\n        let extra = {};\r\n        for (let optionName in raw) {\r\n            if (raw[optionName] === currentRaw[optionName] ||\r\n                (COMPLEX_OPTION_COMPARATORS[optionName] &&\r\n                    COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], currentRaw[optionName]))) {\r\n                refined[optionName] = currentRefined[optionName];\r\n            }\r\n            else {\r\n                if (raw[optionName] === this.currentCalendarOptionsInput[optionName] ||\r\n                    (COMPLEX_OPTION_COMPARATORS[optionName] &&\r\n                        COMPLEX_OPTION_COMPARATORS[optionName](raw[optionName], this.currentCalendarOptionsInput[optionName]))) {\r\n                    if (optionName in this.currentCalendarOptionsRefined) { // might be an \"extra\" prop\r\n                        refined[optionName] = this.currentCalendarOptionsRefined[optionName];\r\n                    }\r\n                }\r\n                else if (refiners[optionName]) {\r\n                    refined[optionName] = refiners[optionName](raw[optionName]);\r\n                }\r\n                else {\r\n                    extra[optionName] = raw[optionName];\r\n                }\r\n                anyChanges = true;\r\n            }\r\n        }\r\n        if (anyChanges) {\r\n            this.currentViewOptionsInput = raw;\r\n            this.currentViewOptionsRefined = refined;\r\n        }\r\n        return {\r\n            rawOptions: this.currentViewOptionsInput,\r\n            refinedOptions: this.currentViewOptionsRefined,\r\n            extra,\r\n        };\r\n    }\r\n}\r\nfunction buildDateEnv$1(timeZone, explicitLocale, weekNumberCalculation, firstDay, weekText, pluginHooks, availableLocaleData, defaultSeparator) {\r\n    let locale = buildLocale(explicitLocale || availableLocaleData.defaultCode, availableLocaleData.map);\r\n    return new DateEnv({\r\n        calendarSystem: 'gregory',\r\n        timeZone,\r\n        namedTimeZoneImpl: pluginHooks.namedTimeZonedImpl,\r\n        locale,\r\n        weekNumberCalculation,\r\n        firstDay,\r\n        weekText,\r\n        cmdFormatter: pluginHooks.cmdFormatter,\r\n        defaultSeparator,\r\n    });\r\n}\r\nfunction buildTheme(options, pluginHooks) {\r\n    let ThemeClass = pluginHooks.themeClasses[options.themeSystem] || StandardTheme;\r\n    return new ThemeClass(options);\r\n}\r\nfunction buildDateProfileGenerator(props) {\r\n    let DateProfileGeneratorClass = props.dateProfileGeneratorClass || DateProfileGenerator;\r\n    return new DateProfileGeneratorClass(props);\r\n}\r\nfunction buildViewApi(type, getCurrentData, dateEnv) {\r\n    return new ViewImpl(type, getCurrentData, dateEnv);\r\n}\r\nfunction buildEventUiBySource(eventSources) {\r\n    return mapHash(eventSources, (eventSource) => eventSource.ui);\r\n}\r\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\r\n    let eventUiBases = { '': eventUiSingleBase };\r\n    for (let defId in eventDefs) {\r\n        let def = eventDefs[defId];\r\n        if (def.sourceId && eventUiBySource[def.sourceId]) {\r\n            eventUiBases[defId] = eventUiBySource[def.sourceId];\r\n        }\r\n    }\r\n    return eventUiBases;\r\n}\r\nfunction buildViewUiProps(calendarContext) {\r\n    let { options } = calendarContext;\r\n    return {\r\n        eventUiSingleBase: createEventUi({\r\n            display: options.eventDisplay,\r\n            editable: options.editable,\r\n            startEditable: options.eventStartEditable,\r\n            durationEditable: options.eventDurationEditable,\r\n            constraint: options.eventConstraint,\r\n            overlap: typeof options.eventOverlap === 'boolean' ? options.eventOverlap : undefined,\r\n            allow: options.eventAllow,\r\n            backgroundColor: options.eventBackgroundColor,\r\n            borderColor: options.eventBorderColor,\r\n            textColor: options.eventTextColor,\r\n            color: options.eventColor,\r\n            // classNames: options.eventClassNames // render hook will handle this\r\n        }, calendarContext),\r\n        selectionConfig: createEventUi({\r\n            constraint: options.selectConstraint,\r\n            overlap: typeof options.selectOverlap === 'boolean' ? options.selectOverlap : undefined,\r\n            allow: options.selectAllow,\r\n        }, calendarContext),\r\n    };\r\n}\r\nfunction computeIsLoading(state, context) {\r\n    for (let isLoadingFunc of context.pluginHooks.isLoadingFuncs) {\r\n        if (isLoadingFunc(state)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction parseContextBusinessHours(calendarContext) {\r\n    return parseBusinessHours(calendarContext.options.businessHours, calendarContext);\r\n}\r\nfunction warnUnknownOptions(options, viewName) {\r\n    for (let optionName in options) {\r\n        console.warn(`Unknown option '${optionName}'` +\r\n            (viewName ? ` for view '${viewName}'` : ''));\r\n    }\r\n}\r\n\r\nclass ToolbarSection extends BaseComponent {\r\n    render() {\r\n        let children = this.props.widgetGroups.map((widgetGroup) => this.renderWidgetGroup(widgetGroup));\r\n        return createElement('div', { className: 'fc-toolbar-chunk' }, ...children);\r\n    }\r\n    renderWidgetGroup(widgetGroup) {\r\n        let { props } = this;\r\n        let { theme } = this.context;\r\n        let children = [];\r\n        let isOnlyButtons = true;\r\n        for (let widget of widgetGroup) {\r\n            let { buttonName, buttonClick, buttonText, buttonIcon, buttonHint } = widget;\r\n            if (buttonName === 'title') {\r\n                isOnlyButtons = false;\r\n                children.push(createElement(\"h2\", { className: \"fc-toolbar-title\", id: props.titleId }, props.title));\r\n            }\r\n            else {\r\n                let isPressed = buttonName === props.activeButton;\r\n                let isDisabled = (!props.isTodayEnabled && buttonName === 'today') ||\r\n                    (!props.isPrevEnabled && buttonName === 'prev') ||\r\n                    (!props.isNextEnabled && buttonName === 'next');\r\n                let buttonClasses = [`fc-${buttonName}-button`, theme.getClass('button')];\r\n                if (isPressed) {\r\n                    buttonClasses.push(theme.getClass('buttonActive'));\r\n                }\r\n                children.push(createElement(\"button\", { type: \"button\", title: typeof buttonHint === 'function' ? buttonHint(props.navUnit) : buttonHint, disabled: isDisabled, \"aria-pressed\": isPressed, className: buttonClasses.join(' '), onClick: buttonClick }, buttonText || (buttonIcon ? createElement(\"span\", { className: buttonIcon, role: \"img\" }) : '')));\r\n            }\r\n        }\r\n        if (children.length > 1) {\r\n            let groupClassName = (isOnlyButtons && theme.getClass('buttonGroup')) || '';\r\n            return createElement('div', { className: groupClassName }, ...children);\r\n        }\r\n        return children[0];\r\n    }\r\n}\r\n\r\nclass Toolbar extends BaseComponent {\r\n    render() {\r\n        let { model, extraClassName } = this.props;\r\n        let forceLtr = false;\r\n        let startContent;\r\n        let endContent;\r\n        let sectionWidgets = model.sectionWidgets;\r\n        let centerContent = sectionWidgets.center;\r\n        if (sectionWidgets.left) {\r\n            forceLtr = true;\r\n            startContent = sectionWidgets.left;\r\n        }\r\n        else {\r\n            startContent = sectionWidgets.start;\r\n        }\r\n        if (sectionWidgets.right) {\r\n            forceLtr = true;\r\n            endContent = sectionWidgets.right;\r\n        }\r\n        else {\r\n            endContent = sectionWidgets.end;\r\n        }\r\n        let classNames = [\r\n            extraClassName || '',\r\n            'fc-toolbar',\r\n            forceLtr ? 'fc-toolbar-ltr' : '',\r\n        ];\r\n        return (createElement(\"div\", { className: classNames.join(' ') },\r\n            this.renderSection('start', startContent || []),\r\n            this.renderSection('center', centerContent || []),\r\n            this.renderSection('end', endContent || [])));\r\n    }\r\n    renderSection(key, widgetGroups) {\r\n        let { props } = this;\r\n        return (createElement(ToolbarSection, { key: key, widgetGroups: widgetGroups, title: props.title, navUnit: props.navUnit, activeButton: props.activeButton, isTodayEnabled: props.isTodayEnabled, isPrevEnabled: props.isPrevEnabled, isNextEnabled: props.isNextEnabled, titleId: props.titleId }));\r\n    }\r\n}\r\n\r\nclass ViewHarness extends BaseComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = {\r\n            availableWidth: null,\r\n        };\r\n        this.handleEl = (el) => {\r\n            this.el = el;\r\n            setRef(this.props.elRef, el);\r\n            this.updateAvailableWidth();\r\n        };\r\n        this.handleResize = () => {\r\n            this.updateAvailableWidth();\r\n        };\r\n    }\r\n    render() {\r\n        let { props, state } = this;\r\n        let { aspectRatio } = props;\r\n        let classNames = [\r\n            'fc-view-harness',\r\n            (aspectRatio || props.liquid || props.height)\r\n                ? 'fc-view-harness-active' // harness controls the height\r\n                : 'fc-view-harness-passive', // let the view do the height\r\n        ];\r\n        let height = '';\r\n        let paddingBottom = '';\r\n        if (aspectRatio) {\r\n            if (state.availableWidth !== null) {\r\n                height = state.availableWidth / aspectRatio;\r\n            }\r\n            else {\r\n                // while waiting to know availableWidth, we can't set height to *zero*\r\n                // because will cause lots of unnecessary scrollbars within scrollgrid.\r\n                // BETTER: don't start rendering ANYTHING yet until we know container width\r\n                // NOTE: why not always use paddingBottom? Causes height oscillation (issue 5606)\r\n                paddingBottom = `${(1 / aspectRatio) * 100}%`;\r\n            }\r\n        }\r\n        else {\r\n            height = props.height || '';\r\n        }\r\n        return (createElement(\"div\", { \"aria-labelledby\": props.labeledById, ref: this.handleEl, className: classNames.join(' '), style: { height, paddingBottom } }, props.children));\r\n    }\r\n    componentDidMount() {\r\n        this.context.addResizeHandler(this.handleResize);\r\n    }\r\n    componentWillUnmount() {\r\n        this.context.removeResizeHandler(this.handleResize);\r\n    }\r\n    updateAvailableWidth() {\r\n        if (this.el && // needed. but why?\r\n            this.props.aspectRatio // aspectRatio is the only height setting that needs availableWidth\r\n        ) {\r\n            this.setState({ availableWidth: this.el.offsetWidth });\r\n        }\r\n    }\r\n}\r\n\r\n/*\r\nDetects when the user clicks on an event within a DateComponent\r\n*/\r\nclass EventClicking extends Interaction {\r\n    constructor(settings) {\r\n        super(settings);\r\n        this.handleSegClick = (ev, segEl) => {\r\n            let { component } = this;\r\n            let { context } = component;\r\n            let seg = getElSeg(segEl);\r\n            if (seg && // might be the <div> surrounding the more link\r\n                component.isValidSegDownEl(ev.target)) {\r\n                // our way to simulate a link click for elements that can't be <a> tags\r\n                // grab before trigger fired in case trigger trashes DOM thru rerendering\r\n                let hasUrlContainer = elementClosest(ev.target, '.fc-event-forced-url');\r\n                let url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\r\n                context.emitter.trigger('eventClick', {\r\n                    el: segEl,\r\n                    event: new EventImpl(component.context, seg.eventRange.def, seg.eventRange.instance),\r\n                    jsEvent: ev,\r\n                    view: context.viewApi,\r\n                });\r\n                if (url && !ev.defaultPrevented) {\r\n                    window.location.href = url;\r\n                }\r\n            }\r\n        };\r\n        this.destroy = listenBySelector(settings.el, 'click', '.fc-event', // on both fg and bg events\r\n        this.handleSegClick);\r\n    }\r\n}\r\n\r\n/*\r\nTriggers events and adds/removes core classNames when the user's pointer\r\nenters/leaves event-elements of a component.\r\n*/\r\nclass EventHovering extends Interaction {\r\n    constructor(settings) {\r\n        super(settings);\r\n        // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\r\n        this.handleEventElRemove = (el) => {\r\n            if (el === this.currentSegEl) {\r\n                this.handleSegLeave(null, this.currentSegEl);\r\n            }\r\n        };\r\n        this.handleSegEnter = (ev, segEl) => {\r\n            if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\r\n                this.currentSegEl = segEl;\r\n                this.triggerEvent('eventMouseEnter', ev, segEl);\r\n            }\r\n        };\r\n        this.handleSegLeave = (ev, segEl) => {\r\n            if (this.currentSegEl) {\r\n                this.currentSegEl = null;\r\n                this.triggerEvent('eventMouseLeave', ev, segEl);\r\n            }\r\n        };\r\n        this.removeHoverListeners = listenToHoverBySelector(settings.el, '.fc-event', // on both fg and bg events\r\n        this.handleSegEnter, this.handleSegLeave);\r\n    }\r\n    destroy() {\r\n        this.removeHoverListeners();\r\n    }\r\n    triggerEvent(publicEvName, ev, segEl) {\r\n        let { component } = this;\r\n        let { context } = component;\r\n        let seg = getElSeg(segEl);\r\n        if (!ev || component.isValidSegDownEl(ev.target)) {\r\n            context.emitter.trigger(publicEvName, {\r\n                el: segEl,\r\n                event: new EventImpl(context, seg.eventRange.def, seg.eventRange.instance),\r\n                jsEvent: ev,\r\n                view: context.viewApi,\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nclass CalendarContent extends PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.buildViewContext = memoize(buildViewContext);\r\n        this.buildViewPropTransformers = memoize(buildViewPropTransformers);\r\n        this.buildToolbarProps = memoize(buildToolbarProps);\r\n        this.headerRef = createRef();\r\n        this.footerRef = createRef();\r\n        this.interactionsStore = {};\r\n        // eslint-disable-next-line\r\n        this.state = {\r\n            viewLabelId: getUniqueDomId(),\r\n        };\r\n        // Component Registration\r\n        // -----------------------------------------------------------------------------------------------------------------\r\n        this.registerInteractiveComponent = (component, settingsInput) => {\r\n            let settings = parseInteractionSettings(component, settingsInput);\r\n            let DEFAULT_INTERACTIONS = [\r\n                EventClicking,\r\n                EventHovering,\r\n            ];\r\n            let interactionClasses = DEFAULT_INTERACTIONS.concat(this.props.pluginHooks.componentInteractions);\r\n            let interactions = interactionClasses.map((TheInteractionClass) => new TheInteractionClass(settings));\r\n            this.interactionsStore[component.uid] = interactions;\r\n            interactionSettingsStore[component.uid] = settings;\r\n        };\r\n        this.unregisterInteractiveComponent = (component) => {\r\n            let listeners = this.interactionsStore[component.uid];\r\n            if (listeners) {\r\n                for (let listener of listeners) {\r\n                    listener.destroy();\r\n                }\r\n                delete this.interactionsStore[component.uid];\r\n            }\r\n            delete interactionSettingsStore[component.uid];\r\n        };\r\n        // Resizing\r\n        // -----------------------------------------------------------------------------------------------------------------\r\n        this.resizeRunner = new DelayedRunner(() => {\r\n            this.props.emitter.trigger('_resize', true); // should window resizes be considered \"forced\" ?\r\n            this.props.emitter.trigger('windowResize', { view: this.props.viewApi });\r\n        });\r\n        this.handleWindowResize = (ev) => {\r\n            let { options } = this.props;\r\n            if (options.handleWindowResize &&\r\n                ev.target === window // avoid jqui events\r\n            ) {\r\n                this.resizeRunner.request(options.windowResizeDelay);\r\n            }\r\n        };\r\n    }\r\n    /*\r\n    renders INSIDE of an outer div\r\n    */\r\n    render() {\r\n        let { props } = this;\r\n        let { toolbarConfig, options } = props;\r\n        let toolbarProps = this.buildToolbarProps(props.viewSpec, props.dateProfile, props.dateProfileGenerator, props.currentDate, getNow(props.options.now, props.dateEnv), // TODO: use NowTimer????\r\n        props.viewTitle);\r\n        let viewVGrow = false;\r\n        let viewHeight = '';\r\n        let viewAspectRatio;\r\n        if (props.isHeightAuto || props.forPrint) {\r\n            viewHeight = '';\r\n        }\r\n        else if (options.height != null) {\r\n            viewVGrow = true;\r\n        }\r\n        else if (options.contentHeight != null) {\r\n            viewHeight = options.contentHeight;\r\n        }\r\n        else {\r\n            viewAspectRatio = Math.max(options.aspectRatio, 0.5); // prevent from getting too tall\r\n        }\r\n        let viewContext = this.buildViewContext(props.viewSpec, props.viewApi, props.options, props.dateProfileGenerator, props.dateEnv, props.theme, props.pluginHooks, props.dispatch, props.getCurrentData, props.emitter, props.calendarApi, this.registerInteractiveComponent, this.unregisterInteractiveComponent);\r\n        let viewLabelId = (toolbarConfig.header && toolbarConfig.header.hasTitle)\r\n            ? this.state.viewLabelId\r\n            : undefined;\r\n        return (createElement(ViewContextType.Provider, { value: viewContext },\r\n            toolbarConfig.header && (createElement(Toolbar, Object.assign({ ref: this.headerRef, extraClassName: \"fc-header-toolbar\", model: toolbarConfig.header, titleId: viewLabelId }, toolbarProps))),\r\n            createElement(ViewHarness, { liquid: viewVGrow, height: viewHeight, aspectRatio: viewAspectRatio, labeledById: viewLabelId },\r\n                this.renderView(props),\r\n                this.buildAppendContent()),\r\n            toolbarConfig.footer && (createElement(Toolbar, Object.assign({ ref: this.footerRef, extraClassName: \"fc-footer-toolbar\", model: toolbarConfig.footer, titleId: \"\" }, toolbarProps)))));\r\n    }\r\n    componentDidMount() {\r\n        let { props } = this;\r\n        this.calendarInteractions = props.pluginHooks.calendarInteractions\r\n            .map((CalendarInteractionClass) => new CalendarInteractionClass(props));\r\n        window.addEventListener('resize', this.handleWindowResize);\r\n        let { propSetHandlers } = props.pluginHooks;\r\n        for (let propName in propSetHandlers) {\r\n            propSetHandlers[propName](props[propName], props);\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        let { props } = this;\r\n        let { propSetHandlers } = props.pluginHooks;\r\n        for (let propName in propSetHandlers) {\r\n            if (props[propName] !== prevProps[propName]) {\r\n                propSetHandlers[propName](props[propName], props);\r\n            }\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        window.removeEventListener('resize', this.handleWindowResize);\r\n        this.resizeRunner.clear();\r\n        for (let interaction of this.calendarInteractions) {\r\n            interaction.destroy();\r\n        }\r\n        this.props.emitter.trigger('_unmount');\r\n    }\r\n    buildAppendContent() {\r\n        let { props } = this;\r\n        let children = props.pluginHooks.viewContainerAppends.map((buildAppendContent) => buildAppendContent(props));\r\n        return createElement(Fragment, {}, ...children);\r\n    }\r\n    renderView(props) {\r\n        let { pluginHooks } = props;\r\n        let { viewSpec } = props;\r\n        let viewProps = {\r\n            dateProfile: props.dateProfile,\r\n            businessHours: props.businessHours,\r\n            eventStore: props.renderableEventStore,\r\n            eventUiBases: props.eventUiBases,\r\n            dateSelection: props.dateSelection,\r\n            eventSelection: props.eventSelection,\r\n            eventDrag: props.eventDrag,\r\n            eventResize: props.eventResize,\r\n            isHeightAuto: props.isHeightAuto,\r\n            forPrint: props.forPrint,\r\n        };\r\n        let transformers = this.buildViewPropTransformers(pluginHooks.viewPropsTransformers);\r\n        for (let transformer of transformers) {\r\n            Object.assign(viewProps, transformer.transform(viewProps, props));\r\n        }\r\n        let ViewComponent = viewSpec.component;\r\n        return (createElement(ViewComponent, Object.assign({}, viewProps)));\r\n    }\r\n}\r\nfunction buildToolbarProps(viewSpec, dateProfile, dateProfileGenerator, currentDate, now, title) {\r\n    // don't force any date-profiles to valid date profiles (the `false`) so that we can tell if it's invalid\r\n    let todayInfo = dateProfileGenerator.build(now, undefined, false); // TODO: need `undefined` or else INFINITE LOOP for some reason\r\n    let prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate, false);\r\n    let nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate, false);\r\n    return {\r\n        title,\r\n        activeButton: viewSpec.type,\r\n        navUnit: viewSpec.singleUnit,\r\n        isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\r\n        isPrevEnabled: prevInfo.isValid,\r\n        isNextEnabled: nextInfo.isValid,\r\n    };\r\n}\r\n// Plugin\r\n// -----------------------------------------------------------------------------------------------------------------\r\nfunction buildViewPropTransformers(theClasses) {\r\n    return theClasses.map((TheClass) => new TheClass());\r\n}\r\n\r\nclass Calendar extends CalendarImpl {\r\n    constructor(el, optionOverrides = {}) {\r\n        super();\r\n        this.isRendering = false;\r\n        this.isRendered = false;\r\n        this.currentClassNames = [];\r\n        this.customContentRenderId = 0;\r\n        this.handleAction = (action) => {\r\n            // actions we know we want to render immediately\r\n            switch (action.type) {\r\n                case 'SET_EVENT_DRAG':\r\n                case 'SET_EVENT_RESIZE':\r\n                    this.renderRunner.tryDrain();\r\n            }\r\n        };\r\n        this.handleData = (data) => {\r\n            this.currentData = data;\r\n            this.renderRunner.request(data.calendarOptions.rerenderDelay);\r\n        };\r\n        this.handleRenderRequest = () => {\r\n            if (this.isRendering) {\r\n                this.isRendered = true;\r\n                let { currentData } = this;\r\n                flushSync(() => {\r\n                    render(createElement(CalendarRoot, { options: currentData.calendarOptions, theme: currentData.theme, emitter: currentData.emitter }, (classNames, height, isHeightAuto, forPrint) => {\r\n                        this.setClassNames(classNames);\r\n                        this.setHeight(height);\r\n                        return (createElement(RenderId.Provider, { value: this.customContentRenderId },\r\n                            createElement(CalendarContent, Object.assign({ isHeightAuto: isHeightAuto, forPrint: forPrint }, currentData))));\r\n                    }), this.el);\r\n                });\r\n            }\r\n            else if (this.isRendered) {\r\n                this.isRendered = false;\r\n                render(null, this.el);\r\n                this.setClassNames([]);\r\n                this.setHeight('');\r\n            }\r\n        };\r\n        ensureElHasStyles(el);\r\n        this.el = el;\r\n        this.renderRunner = new DelayedRunner(this.handleRenderRequest);\r\n        new CalendarDataManager({\r\n            optionOverrides,\r\n            calendarApi: this,\r\n            onAction: this.handleAction,\r\n            onData: this.handleData,\r\n        });\r\n    }\r\n    render() {\r\n        let wasRendering = this.isRendering;\r\n        if (!wasRendering) {\r\n            this.isRendering = true;\r\n        }\r\n        else {\r\n            this.customContentRenderId += 1;\r\n        }\r\n        this.renderRunner.request();\r\n        if (wasRendering) {\r\n            this.updateSize();\r\n        }\r\n    }\r\n    destroy() {\r\n        if (this.isRendering) {\r\n            this.isRendering = false;\r\n            this.renderRunner.request();\r\n        }\r\n    }\r\n    updateSize() {\r\n        flushSync(() => {\r\n            super.updateSize();\r\n        });\r\n    }\r\n    batchRendering(func) {\r\n        this.renderRunner.pause('batchRendering');\r\n        func();\r\n        this.renderRunner.resume('batchRendering');\r\n    }\r\n    pauseRendering() {\r\n        this.renderRunner.pause('pauseRendering');\r\n    }\r\n    resumeRendering() {\r\n        this.renderRunner.resume('pauseRendering', true);\r\n    }\r\n    resetOptions(optionOverrides, changedOptionNames) {\r\n        this.currentDataManager.resetOptions(optionOverrides, changedOptionNames);\r\n    }\r\n    setClassNames(classNames) {\r\n        if (!isArraysEqual(classNames, this.currentClassNames)) {\r\n            let { classList } = this.el;\r\n            for (let className of this.currentClassNames) {\r\n                classList.remove(className);\r\n            }\r\n            for (let className of classNames) {\r\n                classList.add(className);\r\n            }\r\n            this.currentClassNames = classNames;\r\n        }\r\n    }\r\n    setHeight(height) {\r\n        applyStyleProp(this.el, 'height', height);\r\n    }\r\n}\r\n\r\nfunction formatDate(dateInput, options = {}) {\r\n    let dateEnv = buildDateEnv(options);\r\n    let formatter = createFormatter(options);\r\n    let dateMeta = dateEnv.createMarkerMeta(dateInput);\r\n    if (!dateMeta) { // TODO: warning?\r\n        return '';\r\n    }\r\n    return dateEnv.format(dateMeta.marker, formatter, {\r\n        forcedTzo: dateMeta.forcedTzo,\r\n    });\r\n}\r\nfunction formatRange(startInput, endInput, options) {\r\n    let dateEnv = buildDateEnv(typeof options === 'object' && options ? options : {}); // pass in if non-null object\r\n    let formatter = createFormatter(options);\r\n    let startMeta = dateEnv.createMarkerMeta(startInput);\r\n    let endMeta = dateEnv.createMarkerMeta(endInput);\r\n    if (!startMeta || !endMeta) { // TODO: warning?\r\n        return '';\r\n    }\r\n    return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\r\n        forcedStartTzo: startMeta.forcedTzo,\r\n        forcedEndTzo: endMeta.forcedTzo,\r\n        isEndExclusive: options.isEndExclusive,\r\n        defaultSeparator: BASE_OPTION_DEFAULTS.defaultRangeSeparator,\r\n    });\r\n}\r\n// TODO: more DRY and optimized\r\nfunction buildDateEnv(settings) {\r\n    let locale = buildLocale(settings.locale || 'en', organizeRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\r\n    return new DateEnv(Object.assign(Object.assign({ timeZone: BASE_OPTION_DEFAULTS.timeZone, calendarSystem: 'gregory' }, settings), { locale }));\r\n}\r\n\r\n// HELPERS\r\n/*\r\nif nextDayThreshold is specified, slicing is done in an all-day fashion.\r\nyou can get nextDayThreshold from context.nextDayThreshold\r\n*/\r\nfunction sliceEvents(props, allDay) {\r\n    return sliceEventStore(props.eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? props.nextDayThreshold : null).fg;\r\n}\r\n\r\nconst version = '6.1.15';\r\n\r\nexport { Calendar, createPlugin, formatDate, formatRange, globalLocales, globalPlugins, sliceEvents, version };\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}